[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "COMP/STAT112 Notebook",
    "section": "",
    "text": "Welcome\nWelcome to my online portfolio for COMP/STAT112 course taken at Macalester College. Please, use the side bar on the left for navigation.",
    "crumbs": [
      "Welcome"
    ]
  },
  {
    "objectID": "bw/bw-uni.html",
    "href": "bw/bw-uni.html",
    "title": "\n1  Univariate Viz\n",
    "section": "",
    "text": "# Data on students in this class\nsurvey &lt;- read.csv(\"https://hash-mac.github.io/stat112site-s25/data/survey.csv\")\nhikes &lt;- read.csv(\"https://mac-stat.github.io/data/high_peaks.csv\")\n# World Cup data\nworld_cup &lt;- read.csv(\"https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-11-29/worldcups.csv\")\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(viridisLite)\n\n\nggplot(hikes, aes(x = elevation)) +\ngeom_histogram(color = \"white\", binwidth = 200, fill = viridis(1)) +\nlabs(x = \"Elevation (feet)\", y = \"Number of hikes\", title = \"Number of Hikes of Each Elevation\", caption = \"Visualized by: Benjamin Weng\\nSource: Survey\") + theme_minimal()\n\n\n\nNumber of hikes on Each Elevation plotted on bar chart. 4000 ft is the most common hikes while 5300 is the least.\n\n\n\nUse this file to generate a professional looking univariate visualization. The visualization will not perfect the first time but you are expected to improve on it throughout the semester especially after covering advanced topics such as effective viz.",
    "crumbs": [
      "Best Work",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Univariate Viz</span>"
    ]
  },
  {
    "objectID": "bw/bw-bi.html",
    "href": "bw/bw-bi.html",
    "title": "\n2  Bivariate Viz\n",
    "section": "",
    "text": "library(mosaic)\n\nRegistered S3 method overwritten by 'mosaic':\n  method                           from   \n  fortify.SpatialPolygonsDataFrame ggplot2\n\n\n\nThe 'mosaic' package masks several functions from core packages in order to add \nadditional features.  The original behavior of these functions should not be affected by this.\n\n\n\nAttaching package: 'mosaic'\n\n\nThe following objects are masked from 'package:dplyr':\n\n    count, do, tally\n\n\nThe following object is masked from 'package:Matrix':\n\n    mean\n\n\nThe following object is masked from 'package:ggplot2':\n\n    stat\n\n\nThe following objects are masked from 'package:stats':\n\n    binom.test, cor, cor.test, cov, fivenum, IQR, median, prop.test,\n    quantile, sd, t.test, var\n\n\nThe following objects are masked from 'package:base':\n\n    max, mean, min, prod, range, sample, sum\n\nlibrary(fivethirtyeight)\n\nSome larger datasets need to be installed separately, like senators and\nhouse_district_forecast. To install these, we recommend you install the\nfivethirtyeightdata package by running:\ninstall.packages('fivethirtyeightdata', repos =\n'https://fivethirtyeightdata.github.io/drat/', type = 'source')\n\nlibrary(viridisLite)\n\n\ndata(bechdel)\nnew_bechdel &lt;- bechdel |&gt;\n  mutate(clean_test = factor(clean_test, c(\"nowomen\", \"notalk\", \"men\", \"dubious\", \"ok\"))) |&gt;\n  mutate(half_decades = cut(year, breaks = seq(1969, 2014, by = 5)))\n\n\nggplot(new_bechdel, aes(x = half_decades, fill = clean_test)) + labs(x = \"Half Decades\", y = \"Percentage (%)\", fill = \"Legend\", caption = (\"Visualized by: Benjamin Weng\\n Source: Five Thrity-Eight\"), title = \"The Bechdel Test results every half decade\") + geom_bar(position = \"fill\", width = 0.75) + scale_fill_manual(values = viridis(5), labels = c(\"nowomen\" = \"No Women\",  \"notalk\" = \"No Talk Between Women\",  \"men\" = \"Only Talk About Men\",  \"dubious\" = \"Dubious Pass\",  \"ok\" = \"Passes Bechdel Test\" )) + theme_minimal()\n\n\n\nPercentage of Bechdel Test results every half decade.No talk between women is always the most prominent failing factor, but has decreased over time.\n\n\n\nUse this file to generate a professional looking bivariate visualization. The visualization will not perfect the first time but you are expected to improve it throughout the semester especially after covering advanced topics such as effective viz.",
    "crumbs": [
      "Best Work",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Bivariate Viz</span>"
    ]
  },
  {
    "objectID": "bw/bw-tri.html",
    "href": "bw/bw-tri.html",
    "title": "\n3  Trivariate Viz\n",
    "section": "",
    "text": "education &lt;- read.csv(\"https://mac-stat.github.io/data/sat.csv\")\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(viridisLite)\n\n\nggplot(education, aes(x = expend, y = sat, color = fracCat)) + geom_point() + geom_smooth(method = \"lm\") + theme_minimal() + labs(x = \"Expend on Education\", y = \"Average SAT Score\", color = \"Percentage of students taking SAT\", title = \"Percentage of students who Take SAT, Expend on Education, and Average SAT\", caption = \"Visualized by: Benjamin Weng\\nSource: Education\") + scale_color_viridis_d()\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\nPercentage of students taking SAT has a stronger correlation to Average SAT than that of Expend on Education.\n\n\n\nUse this file to generate a professional looking trivariate visualization. The visualization will not perfect the first time but you are expected to improve on it throughout the semester especially after covering advanced topics such as effective viz.",
    "crumbs": [
      "Best Work",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Trivariate Viz</span>"
    ]
  },
  {
    "objectID": "bw/bw-quad.html",
    "href": "bw/bw-quad.html",
    "title": "\n4  Quadvariate Viz\n",
    "section": "",
    "text": "── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\n\n\nggplot(weather, aes(y = temp3pm, x = temp9am, color = location, size = rainfall)) + \n  geom_point() + \n  labs(x = \"9 AM Temperature (°C)\", y = \"3 PM Temperature (°C)\", title = \"Temperature at 9AM, 3AM, and Rainfall at Three Locations\", color = \"Island\", size = \"Rainfall(mm)\", caption = \"Visualized by: Benjamin Weng\\nSource: Weather\") + theme_minimal() + scale_color_viridis_d()\n\nWarning: Removed 69 rows containing missing values or values outside the scale range\n(`geom_point()`).\n\n\n\n\nAt three locations, temperature at 9 AM is positively correlated to 3 AM and seems to be inversely correlated to rainfall.\n\n\n\nUse this file to generate a professional looking quadvariate visualization. The visualization will not perfect the first time but you are expected to improve on it throughout the semester especially after covering advanced topics such as effective viz.",
    "crumbs": [
      "Best Work",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Quadvariate Viz</span>"
    ]
  },
  {
    "objectID": "bw/bw-spatial.html",
    "href": "bw/bw-spatial.html",
    "title": "\n5  Spatial Viz\n",
    "section": "",
    "text": "library(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(openintro)\n\nLoading required package: airports\nLoading required package: cherryblossom\nLoading required package: usdata\n\nlibrary(maps)\n\n\nAttaching package: 'maps'\n\nThe following object is masked from 'package:purrr':\n\n    map\n\nlibrary(ggthemes)\nlibrary(viridisLite)\nstarbucks &lt;- read.csv(\"https://mac-stat.github.io/data/starbucks.csv\")\n\n\nstarbucks_us_by_state &lt;- starbucks |&gt;\n  filter(Country == \"US\") |&gt;\n  count(State.Province) |&gt;\n  mutate(state_name = str_to_lower(abbr2state(State.Province)))\n\n\ncensus_pop_est_2018 &lt;- read_csv(\"https://mac-stat.github.io/data/us_census_2018_state_pop_est.csv\") |&gt;\n  separate(state, into = c(\"dot\", \"state\"), extra = \"merge\") |&gt;\n  select(-dot) |&gt;\n  mutate(state = str_to_lower(state))\n\nRows: 51 Columns: 2\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): state\ndbl (1): est_pop_2018\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nstarbucks_with_2018_pop_est &lt;-\n  starbucks_us_by_state |&gt;\n  left_join(census_pop_est_2018,\n    by = c(\"state_name\" = \"state\")\n  ) |&gt;\n  mutate(starbucks_per_10000 = (n / est_pop_2018) * 10000)\n\n\nstates_map &lt;- map_data(\"state\")\nstarbucks_contiguous_us &lt;- starbucks |&gt;\n  filter(Country == \"US\", State.Province != \"AK\", State.Province != \"HI\")\nggplot(starbucks_with_2018_pop_est, aes(map_id = state_name, fill = starbucks_per_10000)) +\n  geom_map(map = states_map) +\n  expand_limits(x = states_map$long, y = states_map$lat) +\n  geom_point(\n    data = starbucks_contiguous_us,\n    aes(x = Longitude, y = Latitude),\n    size = 0.05,\n    alpha = 0.2,\n    inherit.aes = FALSE) + \n  theme_map() +  scale_fill_gradientn(name = \"starbucks per 10000\", colors = viridis(2), values = scales::rescale(seq(0, 100, by = 5))) + labs(title = \"Starbucks per 10000 in continental US\", caption = \"Visualized by Benjamin Weng\\nSource: Starbucks\")\n\n\n\nStarbucks per 10000 in each US state. Washington has the highest Starbucks-Population proportion, while Mississippi has the lowest.\n\n\n\nUse this file to generate a professional looking spatial visualization. The visualization will not perfect the first time but you are expected to improve on it throughout the semester especially after covering advanced topics such as effective viz.",
    "crumbs": [
      "Best Work",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Spatial Viz</span>"
    ]
  },
  {
    "objectID": "bw/bw-solo project.html",
    "href": "bw/bw-solo project.html",
    "title": "\n6  Solo Project\n",
    "section": "",
    "text": "library(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(sf)\n\nLinking to GEOS 3.13.0, GDAL 3.10.1, PROJ 9.5.1; sf_use_s2() is TRUE\n\nlibrary(viridisLite)\nburritos &lt;- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2023/2023-05-16/tornados.csv')\n\nRows: 68693 Columns: 27\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr   (2): tz, st\ndbl  (21): om, yr, mo, dy, stf, mag, inj, fat, loss, slat, slon, elat, elon,...\nlgl   (1): fc\ndttm  (1): datetime_utc\ndate  (1): date\ntime  (1): time\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\nshape &lt;- read_sf(\"tl_2024_us_county\\\\tl_2024_us_county.shp\")\n\nohio_shape &lt;- shape|&gt;\n  filter(STATEFP == 39)|&gt; #Ohio state number\n  mutate(COUNTYFP = as.numeric(COUNTYFP))\n\n\nOHburritos &lt;- burritos|&gt;\n  filter(st == \"OH\", ns == 1)|&gt; #Filtering out Ohio tornado. Number of state affected filtered to 1.\n  select(om, date, loss, f1, f2, f3, f4)|&gt;\n  pivot_longer(cols = c(f1, f2, f3, f4), names_to = \"county_order\", values_to = \"county_code\")|&gt; #pivot long so I can count\n  count(county_code, name = \"n_burritos\")|&gt;\n  filter(county_code != 0)|&gt; #0 is placeholder for NA so filter\n  mutate(county_code = as.numeric(county_code))\n\n\nmap_burrito &lt;- ohio_shape |&gt;\n  left_join(OHburritos, by = c(\"COUNTYFP\" = \"county_code\"))\n\n\nOHpop &lt;- read_csv(\"PopulationEstimates.csv\")\n\nRows: 208225 Columns: 5\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (3): State, Area_Name, Attribute\ndbl (2): FIPStxt, Value\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nOHpop &lt;- OHpop |&gt;\n  filter(State == \"OH\", Attribute == \"POP_ESTIMATE_2023\", FIPStxt != 39000)|&gt;\n  mutate(FIPStxt = as.numeric(str_sub(FIPStxt, 3)))\n\n\nmap_ohpop &lt;- ohio_shape |&gt;\n  left_join(OHpop, by = c(\"COUNTYFP\" = \"FIPStxt\"))\n\n\nggplot() + geom_sf(data = map_burrito, aes(fill = n_burritos)) + labs(title = \"Ohio Counties by Number of Tornadoes, 1950 - 2022\", fill = \"Tornado Count\", caption = \"Visualized by: Benjamin Weng\\nSource: TidyTuesday/NOAA\") + theme_minimal() + scale_fill_viridis_c(option = \"rocket\", direction = -1)\n\n\n\nFranklin, Van Vert, Lorain, Huron, Medina, Clinton, Miami, and Clark counties are most heavily affected.\n\n\n\n\nggplot() + geom_sf(data = map_ohpop, aes(fill = Value)) + labs(title = \"Ohio Counties by Population, 2023\", fill = \"Population\", caption = \"Visualized by: Benjamin Weng\\nSource: USDA\") + theme_minimal() + scale_fill_viridis_c(option = \"rocket\", direction = -1)\n\n\n\nOhio population by county. Cuyahoga, Franklin, and Hamilton counties are most populated due to cities.\n\n\n\nIt almost seems like the surrounding counties of major cities have far more tornadoes. My hypotheses are: 1. Tornado report is heavily relied on sightings. Without sightings, the rural area has more tornadoes unreported. 2. Major cities monitor their tornadoes more heavily due to safety concerns. This includes monitoring surrounding counties. 3. The urban counties themselves don’t seem to have too many tornadoes except for Franklin. It might be due to the nature of urban landscape is less prone to tornadoes.",
    "crumbs": [
      "Best Work",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Solo Project</span>"
    ]
  },
  {
    "objectID": "bw/bw-exam1.html",
    "href": "bw/bw-exam1.html",
    "title": "\n7  Exam 1\n",
    "section": "",
    "text": "library(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(tidytuesdayR)\nlibrary(viridisLite)\n\n\ntuesdata &lt;- tt_load(\"2020-02-18\")\n\n---- Compiling #TidyTuesday Information for 2020-02-18 ----\n--- There is 1 file available ---\n\n\n── Downloading files ───────────────────────────────────────────────────────────\n\n  1 of 1: \"food_consumption.csv\"\n\nfc &lt;- tuesdata$food_consumption\n\n\nstr(tuesdata)\n\nList of 1\n $ food_consumption: spc_tbl_ [1,430 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)\n  ..$ country      : chr [1:1430] \"Argentina\" \"Argentina\" \"Argentina\" \"Argentina\" ...\n  ..$ food_category: chr [1:1430] \"Pork\" \"Poultry\" \"Beef\" \"Lamb & Goat\" ...\n  ..$ consumption  : num [1:1430] 10.51 38.66 55.48 1.56 4.36 ...\n  ..$ co2_emmission: num [1:1430] 37.2 41.53 1712 54.63 6.96 ...\n  ..- attr(*, \"spec\")=\n  .. .. cols(\n  .. ..   country = col_character(),\n  .. ..   food_category = col_character(),\n  .. ..   consumption = col_double(),\n  .. ..   co2_emmission = col_double()\n  .. .. )\n  ..- attr(*, \"problems\")=&lt;externalptr&gt; \n - attr(*, \".tt\")= 'tt' chr \"food_consumption.csv\"\n  ..- attr(*, \".files\")='data.frame':   1 obs. of  3 variables:\n  .. ..$ data_files: chr \"food_consumption.csv\"\n  .. ..$ data_type : chr \"csv\"\n  .. ..$ delim     : chr \",\"\n  ..- attr(*, \".readme\")=List of 2\n  .. ..$ node:&lt;externalptr&gt; \n  .. ..$ doc :&lt;externalptr&gt; \n  .. ..- attr(*, \"class\")= chr [1:2] \"xml_document\" \"xml_node\"\n  ..- attr(*, \".date\")= Date[1:1], format: \"2020-02-18\"\n - attr(*, \"class\")= chr \"tt_data\"\n\nhead(tuesdata, 6)\n\n$food_consumption\n# A tibble: 1,430 × 4\n   country   food_category            consumption co2_emmission\n   &lt;chr&gt;     &lt;chr&gt;                          &lt;dbl&gt;         &lt;dbl&gt;\n 1 Argentina Pork                           10.5          37.2 \n 2 Argentina Poultry                        38.7          41.5 \n 3 Argentina Beef                           55.5        1712   \n 4 Argentina Lamb & Goat                     1.56         54.6 \n 5 Argentina Fish                            4.36          6.96\n 6 Argentina Eggs                           11.4          10.5 \n 7 Argentina Milk - inc. cheese            195.          278.  \n 8 Argentina Wheat and Wheat Products      103.           19.7 \n 9 Argentina Rice                            8.77         11.2 \n10 Argentina Soybeans                        0             0   \n# ℹ 1,420 more rows\n\ndim(tuesdata)\n\nNULL\n\nclass(tuesdata)\n\n[1] \"tt_data\"\n\ntail(tuesdata, 6)\n\n$food_consumption\n# A tibble: 1,430 × 4\n   country   food_category            consumption co2_emmission\n   &lt;chr&gt;     &lt;chr&gt;                          &lt;dbl&gt;         &lt;dbl&gt;\n 1 Argentina Pork                           10.5          37.2 \n 2 Argentina Poultry                        38.7          41.5 \n 3 Argentina Beef                           55.5        1712   \n 4 Argentina Lamb & Goat                     1.56         54.6 \n 5 Argentina Fish                            4.36          6.96\n 6 Argentina Eggs                           11.4          10.5 \n 7 Argentina Milk - inc. cheese            195.          278.  \n 8 Argentina Wheat and Wheat Products      103.           19.7 \n 9 Argentina Rice                            8.77         11.2 \n10 Argentina Soybeans                        0             0   \n# ℹ 1,420 more rows\n\n\n\nfc_clean &lt;- fc |&gt;\n  select(c(country, food_category, consumption))\n\n\nfc_clean |&gt;\n  mutate(country = fct_rev(factor(country)))|&gt;\n  ggplot(aes(x = country, y = consumption, fill = food_category)) +\n    geom_bar(stat = \"identity\") +\n    labs(title = \"Food Consumption by Category Across Countries\",\n      x = \"Country\",\n      y = \"Consumption kg/person/year\",\n      caption = \"Visualized by Benjamin Weng\\nSource: TidyTuesday\",\n      fill = \"Food Category\") +\n    theme_minimal() + coord_flip() + scale_fill_viridis_d()\n\n\n\nAll countries’ different food consumption category plotted on one graph. Countries have very different consumption.\n\n\n\nThought Process: pretty regular stacked bar plotting, but I found the country name hard to read so flipped the coordinates.\nAdditional Questions: 1. What country consumes the most diary product? 2. What are the trends of CO2 emission?",
    "crumbs": [
      "Best Work",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Exam 1</span>"
    ]
  },
  {
    "objectID": "bw/bw-exam2.html",
    "href": "bw/bw-exam2.html",
    "title": "\n8  Exam 2\n",
    "section": "",
    "text": "library(tidytuesdayR)\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(rnaturalearth)\nlibrary(sf)\n\nLinking to GEOS 3.13.0, GDAL 3.10.1, PROJ 9.5.1; sf_use_s2() is TRUE\n\nlibrary(viridisLite)\n\n\ntuesdata &lt;- tt_load(\"2020-02-18\")\n\n---- Compiling #TidyTuesday Information for 2020-02-18 ----\n--- There is 1 file available ---\n\n\n── Downloading files ───────────────────────────────────────────────────────────\n\n  1 of 1: \"food_consumption.csv\"\n\nfc &lt;- tuesdata$food_consumption\n\n\nstr(fc)\n\nspc_tbl_ [1,430 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)\n $ country      : chr [1:1430] \"Argentina\" \"Argentina\" \"Argentina\" \"Argentina\" ...\n $ food_category: chr [1:1430] \"Pork\" \"Poultry\" \"Beef\" \"Lamb & Goat\" ...\n $ consumption  : num [1:1430] 10.51 38.66 55.48 1.56 4.36 ...\n $ co2_emmission: num [1:1430] 37.2 41.53 1712 54.63 6.96 ...\n - attr(*, \"spec\")=\n  .. cols(\n  ..   country = col_character(),\n  ..   food_category = col_character(),\n  ..   consumption = col_double(),\n  ..   co2_emmission = col_double()\n  .. )\n - attr(*, \"problems\")=&lt;externalptr&gt; \n\nhead(fc, 22)\n\n# A tibble: 22 × 4\n   country   food_category            consumption co2_emmission\n   &lt;chr&gt;     &lt;chr&gt;                          &lt;dbl&gt;         &lt;dbl&gt;\n 1 Argentina Pork                           10.5          37.2 \n 2 Argentina Poultry                        38.7          41.5 \n 3 Argentina Beef                           55.5        1712   \n 4 Argentina Lamb & Goat                     1.56         54.6 \n 5 Argentina Fish                            4.36          6.96\n 6 Argentina Eggs                           11.4          10.5 \n 7 Argentina Milk - inc. cheese            195.          278.  \n 8 Argentina Wheat and Wheat Products      103.           19.7 \n 9 Argentina Rice                            8.77         11.2 \n10 Argentina Soybeans                        0             0   \n# ℹ 12 more rows\n\n\n\nfcc &lt;- fc |&gt;\n  mutate(food_category = str_replace(food_category, \"Lamb & Goat\", \"Lamb\"))|&gt;\n  mutate(food_category = str_replace(food_category, \"Milk - inc. cheese\", \"Diary\"))|&gt;\n  mutate(food_category = str_replace(food_category, \"Wheat and Wheat Products\", \"Wheat\"))|&gt;\n  mutate(food_category = str_replace(food_category, \"Nuts inc. Peanut Butter\", \"Nuts\"))\n\nResearch Question 1:\n\nfcc|&gt;\n  select(country, consumption)|&gt;\n  group_by(country)|&gt;\n  summarise(consumption = sum(consumption))|&gt;\n  arrange(desc(consumption))|&gt;\n  head(5)|&gt;\n  ggplot( aes(x = country, y = consumption)) +\n  geom_col(fill = \"blue\") +\n  labs(title = \"5 countries with highest consumptions\", x = \"Country\", y = \"Consumption\", caption = \"Visualized by Benjamin Weng\\nSource: TidyTuesday\") + theme_minimal()\n\n\n\n5 Countries with most food consumptions are Albania, Finland, Lithuania, Netherlands, and Sweden.\n\n\n\nResearch Question 2:\n\nfcc |&gt;\n  select(country, food_category, consumption)|&gt;\n  group_by(food_category)|&gt;\n  slice_max(consumption, n=5)|&gt;\n  ungroup()|&gt;\n  ggplot(aes(x = country, y = consumption)) + geom_col(fill = \"blue\") + coord_flip() + facet_wrap(~food_category, scales = \"free_y\") +\n  labs(title = \"Top 5 Countries by Food Category Consumption\", x = \"Country\", y = \"Consumption\", caption = \"Visualized by Benjamin Weng\\nSource: TidyTuesday\") + theme_minimal()\n\n\n\n5 Countries with most food consumptions in each category. There are a lot of data.\n\n\n\nResearch Question 3:\n\nfcc_forjoin &lt;- fcc |&gt;\n    select(-co2_emmission)|&gt;\n    group_by(food_category)|&gt;\n    mutate(consumption = (consumption - mean(consumption))/sd(consumption))\n\n\nne_countries(returnclass = \"sf\")|&gt;\n  select(name, geometry)|&gt;\n  mutate(name = ifelse(name == \"United States of America\", \"USA\", name)) |&gt;\n  mutate(name = ifelse(name == \"Bosnia and Herz.\", \"Bosnia and Herzegovina\", name)) |&gt;\n  mutate(name = ifelse(name == \"Czechia\", \"Czech Republic\", name)) |&gt;\n  mutate(name = ifelse(name == \"Taiwan\", \"Taiwan. ROC\", name)) |&gt;\n  left_join(fcc_forjoin, join_by(name == country))|&gt;\n  pivot_wider(names_from = food_category, values_from = consumption)|&gt;\n  select(-\"NA\")|&gt;\n  pivot_longer(cols = c(-name, -geometry), names_to = \"food_category\", values_to = \"consumption\")|&gt;\n  ggplot() + geom_sf(aes(fill = consumption)) + facet_wrap(~food_category) + theme(legend.position = \"bottom\") + labs(title = \"Consumption of Each Food Type By Country\", caption = \"Visualized by Benjamin Weng\\nSource: TidyTuesday\") + scale_fill_viridis_c() \n\n\n\nStandardized map for each food type’s consumption.",
    "crumbs": [
      "Best Work",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Exam 2</span>"
    ]
  },
  {
    "objectID": "ica/ica-uni.html",
    "href": "ica/ica-uni.html",
    "title": "\n11  Univariate Viz\n",
    "section": "",
    "text": "11.0.1 Import data\n\nhikes &lt;- read.csv(\"https://mac-stat.github.io/data/high_peaks.csv\")\n\n\nlibrary(tidyverse)\n\nExercise 1: Research Questions\nLet’s dig into the hikes data, starting with the elevation and difficulty ratings of the hikes:\n\nWhat features would we like a visualization of the categorical difficulty rating variable to capture?\n\nUsing a bar chart for the three categories: easy, moderate, and difficult.\n\nWhat about a visualization of the quantitative elevation variable?\n\nUse a histogram to show the difference in heights.\nExercise 2: Load tidyverse\nWe’ll address the above questions using ggplot tools. Try running the following chunk and simply take note of the error message – this is one you’ll get a lot!\n\n# Use the ggplot function\nggplot(hikes, aes(x = rating))\n\n\n\n\n\n\n\nIn order to use ggplot tools, we have to first load the tidyverse package in which they live. We’ve installed the package but we need to tell R when we want to use it. Run the chunk below to load the library. You’ll need to do this within any .qmd file that uses ggplot().\n\nlibrary(tidyverse)\n\nExercise 3: Bar Chart of Ratings - Part 1\nConsider some specific research questions about the difficulty rating of the hikes:\n\nHow many hikes fall into each category?\n\nThree on ‘moderate’, two on ‘difficult’, and one on ‘easy’\n\nAre the hikes evenly distributed among these categories, or are some more common than others?\n\nModerate is more common than easy.\nAll of these questions can be answered with: (1) a bar chart; of (2) the categorical data recorded in the rating column. First, set up the plotting frame:\n\nggplot(hikes, aes(x = rating))\n\n\n\n\n\n\n\nThink about:\n\nWhat did this do? What do you observe?\n\nGenerates an empty bar chart with all categories in ‘rating’ on x-axis\n\nWhat, in general, is the first argument of the ggplot() function?\n\nThe dataset used for plot\n\nWhat is the purpose of writing x = rating?\n\nAssigns the x-axis to the category ‘rating’\n\nWhat do you think aes stands for?!?\n\nAesthetics\nExercise 4: Bar Chart of Ratings - Part 2\nNow let’s add a geometric layer to the frame / canvas, and start customizing the plot’s theme. To this end, try each chunk below, one by one. In each chunk, make a comment about how both the code and the corresponding plot both changed.\nNOTE:\n\nPay attention to the general code properties and structure, not memorization.\nNot all of these are “good” plots. We’re just exploring ggplot.\n\n\n# geom_bar is added to the ggplot function; three bars were created with a y-axis defaulted as 'count'\nggplot(hikes, aes(x = rating)) +\n  geom_bar()\n\n\n\n\n\n\n\n\n# labs() function is added. It labels the x and y axis\nggplot(hikes, aes(x = rating)) +\n  geom_bar() +\n  labs(x = \"Rating\", y = \"Number of hikes\")\n\n\n\n\n\n\n\n\n# fill = \"blue\" is added into the geom_bar as an argument. It fills the color(string) into the bar.\nggplot(hikes, aes(x = rating)) +\n  geom_bar(fill = \"blue\") +\n  labs(x = \"Rating\", y = \"Number of hikes\")\n\n\n\n\n\n\n\n\n# color = \"orange\" is added to geom_bar as an argument. It colors the frames of the bars.\nggplot(hikes, aes(x = rating)) +\n  geom_bar(color = \"orange\", fill = \"blue\") +\n  labs(x = \"Rating\", y = \"Number of hikes\")\n\n\n\n\n\n\n\n\n# theme_minimal() is added. It changes the background color to white\nggplot(hikes, aes(x = rating)) +\n  geom_bar(color = \"orange\", fill = \"blue\")  +\n  labs(x = \"Rating\", y = \"Number of hikes\") +\n  theme_minimal()\n\n\n\n\n\n\n\nExercise 5: Bar Chart Follow-up\nPart a\nReflect on the ggplot() code.\n\nWhat’s the purpose of the +? When do we use it?\n\nAdd an element to the graph.\n\nWe added the bars using geom_bar()? Why “geom”?\n\nGeom mean geometry. Geometry\n\nWhat does labs() stand for?\n\nLabels\n\nWhat’s the difference between color and fill?\n\nFill is filling the inside of something, while color only changes the color of the outline.\nPart b\nIn general, bar charts allow us to examine the following properties of a categorical variable:\n\n\nobserved categories: What categories did we observe?\n\nrating of easy, moderate, and difficult\n\n\nvariability between categories: Are observations evenly spread out among the categories, or are some categories more common than others?\n\nModerate difficulty mountains are the most common, followed by easy. Difficult mountain is very rare.\nWe must then translate this information into the context of our analysis, here hikes in the Adirondacks. Summarize below what you learned from the bar chart, in context.\nPart c\nIs there anything you don’t like about this barplot? For example: check out the x-axis again.\nIt would be better if it were easy-moderate-difficult.\nExercise 6: Sad Bar Chart\nLet’s now consider some research questions related to the quantitative elevation variable:\n\nAmong the hikes, what’s the range of elevation and how are the hikes distributed within this range (e.g. evenly, in clumps, “normally”)?\nWhat’s a typical elevation?\nAre there any outliers, i.e. hikes that have unusually high or low elevations?\n\nHere:\n\nConstruct a bar chart of the quantitative elevation variable.\n\n\nggplot(hikes, aes(x = elevation)) +\n  geom_bar(color = \"orange\", fill = \"blue\")  +\n  labs(x = \"Elevation\", y = \"Number of hikes\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\nExplain why this might not be an effective visualization for this and other quantitative variables. (What questions does / doesn’t it help answer?)\n\nThere are too many different heights.\nExercise 7: A Histogram of Elevation\nQuantitative variables require different viz than categorical variables. Especially when there are many possible outcomes of the quantitative variable. It’s typically insufficient to simply count up the number of times we’ve observed a particular outcome as the bar graph did above. It gives us a sense of ranges and typical outcomes, but not a good sense of how the observations are distributed across this range. We’ll explore two methods for graphing quantitative variables: histograms and density plots.\nHistograms are constructed by (1) dividing up the observed range of the variable into ‘bins’ of equal width; and (2) counting up the number of cases that fall into each bin. Check out the example below:\n\nPart a\nLet’s dig into some details.\n\nHow many hikes have an elevation between 4500 and 4700 feet?\n\n6\n\nHow many total hikes have an elevation of at least 5100 feet?\n\n3\nPart b\nNow the bigger picture. In general, histograms allow us to examine the following properties of a quantitative variable:\n\n\ntypical outcome: Where’s the center of the data points? What’s typical?\n\n4700ft\n\n\nvariability & range: How spread out are the outcomes? What are the max and min outcomes?\n\nIt is clumped to the lower elevation region. Max is 3900-4100, 10, min is 5100-5300, 1\n\n\nshape: How are values distributed along the observed range? Is the distribution symmetric, right-skewed, left-skewed, bi-modal, or uniform (flat)?\n\nleft-skewed\n\n\noutliers: Are there any outliers, i.e. outcomes that are unusually large/small?\n\nNo.\nWe must then translate this information into the context of our analysis, here hikes in the Adirondacks. Addressing each of the features in the above list, summarize below what you learned from the histogram, in context.\nThe elevations are unevenly distributed. It is skewed to be lower and there are no significant outliers\nExercise 8: Building Histograms - Part 1\n2-MINUTE CHALLENGE: Thinking of the bar chart code, try to intuit what line you can tack on to the below frame of elevation to add a histogram layer. Don’t forget a +. If it doesn’t come to you within 2 minutes, no problem – all will be revealed in the next exercise.\n\nggplot(hikes, aes(x = elevation)) + geom_histogram()\n\n\n\n\n\n\n\nExercise 9: Building Histograms - Part 2\nLet’s build some histograms. Try each chunk below, one by one. In each chunk, make a comment about how both the code and the corresponding plot both changed.\n\n# Creates a histogram\nggplot(hikes, aes(x = elevation)) +\n  geom_histogram()\n\n\n\n\n\n\n\n\n# Let the boundary of the bars become white.\nggplot(hikes, aes(x = elevation)) +\n  geom_histogram(color = \"white\") \n\n\n\n\n\n\n\n\n# Fill the inside of the bard blue\nggplot(hikes, aes(x = elevation)) +\n  geom_histogram(color = \"white\", fill = \"blue\") \n\n\n\n\n\n\n\n\n# Change the x-axis and y-axis\nggplot(hikes, aes(x = elevation)) +\n  geom_histogram(color = \"white\") +\n  labs(x = \"Elevation (feet)\", y = \"Number of hikes\")\n\n\n\n\n\n\n\n\n# Change the width of each interval to 1000.\nggplot(hikes, aes(x = elevation)) +\n  geom_histogram(color = \"white\", binwidth = 1000) +\n  labs(x = \"Elevation (feet)\", y = \"Number of hikes\")\n\n\n\n\n\n\n\n\n# Change the interval to 5 \nggplot(hikes, aes(x = elevation)) +\n  geom_histogram(color = \"white\", binwidth = 5) +\n  labs(x = \"Elevation (feet)\", y = \"Number of hikes\")\n\n\n\n\n\n\n\n\n# Change the interval to 200\nggplot(hikes, aes(x = elevation)) +\n  geom_histogram(color = \"white\", binwidth = 200) +\n  labs(x = \"Elevation (feet)\", y = \"Number of hikes\")\n\n\n\n\n\n\n\nExercise 10: Histogram Follow-up\n\nWhat function added the histogram layer / geometry?\n\ngeom_histogram()\n\nWhat’s the difference between color and fill?\n\nColor is for the borders of the bars, while fill is for the interior\n\nWhy does adding color = \"white\" improve the visualization?\n\nIt separates the bars.\n\nWhat did binwidth do?\n\nChange the intervals in between bars.\n\nWhy does the histogram become ineffective if the binwidth is too big (e.g. 1000 feet)?\n\nBecause there are too few categories\n\nWhy does the histogram become ineffective if the binwidth is too small (e.g. 5 feet)?\n\nThere are too many categories\nExercise 11: Density Plots\nDensity plots are essentially smooth versions of the histogram. Instead of sorting observations into discrete bins, the “density” of observations is calculated across the entire range of outcomes. The greater the number of observations, the greater the density! The density is then scaled so that the area under the density curve always equals 1 and the area under any fraction of the curve represents the fraction of cases that lie in that range.\nCheck out a density plot of elevation. Notice that the y-axis (density) has no contextual interpretation – it’s a relative measure. The higher the density, the more common are elevations in that range.\n\nggplot(hikes, aes(x = elevation)) +\n  geom_density()\n\n\n\n\n\n\n\nQuestions\n\nINTUITION CHECK: Before tweaking the code and thinking back to geom_bar() and geom_histogram(), how do you anticipate the following code will change the plot?\n\nLine will be blue and area under curve will be orange.\n-   `geom_density(color = \"blue\")`\n-   `geom_density(fill = \"orange\")`\n\nTRY IT! Test out those lines in the chunk below. Was your intuition correct?\n\n\nggplot(hikes, aes(x = elevation)) +\n  geom_density(color = \"blue\", fill = \"orange\")\n\n\n\n\n\n\n\n\nExamine the density plot. How does it compare to the histogram? What does it tell you about the typical elevation, variability / range in elevations, and shape of the distribution of elevations within this range?\n\nIt is continuous compared to the density. The most typical elebation is around 4200 fts. Range is from around 3800-5300. Shape is skewed to the left.\nExercise 12: Density Plots vs Histograms\nThe histogram and density plot both allow us to visualize the behavior of a quantitative variable: typical outcome, variability / range, shape, and outliers. What are the pros/cons of each? What do you like/not like about each?\nHistograms give exact number of all elevation, but doesn’t give a continuous graph. Density gives continuous graph. But it is less straighforward in terms of number of each category.\nExercise 13: Code = communication\nWe obviously won’t be done until we talk about communication. All code above has a similar general structure (where the details can change):\n\nggplot(___, aes(x = ___)) + \n  geom___(color = \"___\", fill = \"___\") + \n  labs(x = \"___\", y = \"___\")\n\n\nThough not necessary to the code working, it’s common, good practice to indent or tab the lines of code after the first line (counterexample below). Why?\n\nThe style of the code is bad without indents\n\nggplot(hikes, aes(x = elevation)) +\ngeom_histogram(color = \"white\", binwidth = 200) +\nlabs(x = \"Elevation (feet)\", y = \"Number of hikes\")\n\n\n\n\n\n\n\n\nThough not necessary to the code working, it’s common, good practice to put a line break after each + (counterexample below). Why?\n\nEach line is too long to read without line breaks.\n\n# YUCK \nggplot(hikes, aes(x = elevation)) + geom_histogram(color = \"white\", binwidth = 200) + labs(x = \"Elevation (feet)\", y = \"Number of hikes\")\n\n\n\n\n\n\n\nExercise 14: Practice\nPart a\nPractice your viz skills to learn about some of the variables in one of the following datasets from the previous class:\n\n# Data on students in this class\nsurvey &lt;- read.csv(\"https://hash-mac.github.io/stat112site-s25/data/survey.csv\")\n\n# World Cup data\nworld_cup &lt;- read.csv(\"https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-11-29/worldcups.csv\")\n\n\n  ggplot(world_cup, aes(x = host)) + geom_bar(color = \"brown\")\n\n\n\n\n\n\n\nPart b\nCheck out the RStudio Data Visualization cheat sheet to learn more features of ggplot.\n\n\n\n\n\n\nCheck → Commit → Push\n\n\n\nWhen done, don’t forgot to click Render Book and check the resulting HTML files. If happy, jump to GitHub Desktop and commit the changes with the message Finish activity 3 and push to GitHub. Wait few seconds, then visit your portfolio website and make sure the changes are there.",
    "crumbs": [
      "In-class Activities",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Univariate Viz</span>"
    ]
  },
  {
    "objectID": "ica/ica-bi.html",
    "href": "ica/ica-bi.html",
    "title": "\n12  Bivariate Viz\n",
    "section": "",
    "text": "Exercise 0: Review",
    "crumbs": [
      "In-class Activities",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Bivariate Viz</span>"
    ]
  },
  {
    "objectID": "ica/ica-bi.html#exercises-optional",
    "href": "ica/ica-bi.html#exercises-optional",
    "title": "\n12  Bivariate Viz\n",
    "section": "\n12.1 Exercises (optional)",
    "text": "12.1 Exercises (optional)\nThe above visualizations are foundational and important. But they’re not the only way to visualize the variables in our dataset.\nOptional Exercise 1: Many Categories\nSuppose we wanted to better understand how the 2020 Republican support varied from county to county within each state. Since repub_pct_20 is quantitative and state_abbr is categorical, we could make a density plot of repub_pct_20 for each state. Reflect on why this is bad.\n\nggplot(elections, aes(x = repub_pct_20, fill = state_abbr)) + \n  geom_density(alpha = 0.5)\n\n\n\n\n\n\n\nA facet wrap would also be bad!\n\nggplot(elections, aes(x = repub_pct_20)) + \n  geom_density(alpha = 0.5) + \n  facet_wrap(~ state_abbr)\n\n\n\n\n\n\n\nWhen we want to compare the distribution of some quantitative outcome among many groups / categories, a ridgeline plot can be a good option. These are also called joy plots, named after the album cover for “Unknown Pleasures” by Joy Division. (Look it up!) To make a ridgeline plot, we can use the geom_density_ridges() function from the ggridges package.\n\n# Install ggridges package\nlibrary(ggridges)\n\n# Make our first joy plot\n# THINK: What DON'T you like about this?\nggplot(elections, aes(x = repub_pct_20, y = state_abbr)) + \n  geom_density_ridges()\n\n\n# Let's put the states in order by Republican support, not alphabet\n# How do you think fct_reorder works? We'll learn about this later in the semester.\nggplot(elections, aes(x = repub_pct_20, y = fct_reorder(state_abbr, repub_pct_20))) + \n  geom_density_ridges(alpha = 0.5)\n\n\n# YOUR TURN: color/fill the ridges according to a state's historical voting patterns \n# and add meaningful axis labels\n\nFollow-up questions\n\nWhich states tend to have the most variability in outcomes from county to county? The least?\nWhat other interesting patterns do you notice?\nDoes this plot prompt any other questions?\nOptional Exercise 2: Total Outcomes by State\nLet’s import some new data and counts up the total votes (Republican and Democratic) by state, not county. This was wrangled from the elections data!\n\nelections_by_state &lt;- read.csv(\"https://mac-stat.github.io/data/election_2020_by_state.csv\")\n\nFor example, we might make a scatterplot of the 2020 vs 2016 outcomes:\n\nggplot(elections_by_state, aes(y = repub_pct_20, x = repub_pct_16)) + \n  geom_point()\n\n\n\n\n\n\n\nBUT this isn’t the easiest way to communicate or identify the changes from 1 year to the next.\n\n# YOU TRY\n# Start by creating a \"scatterplot\" of state_abbr (y-axis) by 2020 Republican support on the x-axis\n# Color the points red\n# Scroll to solutions below when you're ready\n\n\n# Check it out\nggplot(elections_by_state, aes(x = repub_pct_20, y = state_abbr)) + \n  geom_point(color = \"red\")\n\n\n\n\n\n\n\n\n# YOU TRY\n# Reorder the states in terms of their 2020 Republican support (not alphabet)\n# Scroll to solutions below when you're ready\n\n\n# Check it out\nggplot(elections_by_state, aes(x = repub_pct_20, y = fct_reorder(state_abbr, repub_pct_20))) + \n  geom_point(color = \"red\")\n\n\n\n\n\n\n\n\n# Finally, add ANOTHER layer of points for the 2016 outcomes\n# What info does this new geom_point() layer need to run?\nggplot(elections_by_state, aes(x = repub_pct_20, y = fct_reorder(state_abbr, repub_pct_20))) + \n  geom_point(color = \"red\") + \n  geom_point(aes(x = repub_pct_16, y = state_abbr))\n\n\n\n\n\n\n\nReflect on the following\n\nWhat do you think this plot needs? Try it! You might need to do some digging online.\nSummarize the main takeaways from the plots. Which states changed the most from 2016 to 2020? The least? Where did the Republican support increase? Where did it decrease?\nWhat other questions are you left with?",
    "crumbs": [
      "In-class Activities",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Bivariate Viz</span>"
    ]
  },
  {
    "objectID": "ica/ica-multi.html",
    "href": "ica/ica-multi.html",
    "title": "\n13  Mulivariate Viz\n",
    "section": "",
    "text": "13.1 Exercises (required)",
    "crumbs": [
      "In-class Activities",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Mulivariate Viz</span>"
    ]
  },
  {
    "objectID": "ica/ica-multi.html#exercises-required",
    "href": "ica/ica-multi.html#exercises-required",
    "title": "\n13  Mulivariate Viz\n",
    "section": "",
    "text": "The story\nThough far from a perfect assessment of academic preparedness, SAT scores have historically been used as one measurement of a state’s education system. The education dataset contains various education variables for each state:\n\n# Import and check out data\neducation &lt;- read.csv(\"https://mac-stat.github.io/data/sat.csv\")\nhead(education)\n\n       State expend ratio salary frac verbal math  sat  fracCat\n1    Alabama  4.405  17.2 31.144    8    491  538 1029   (0,15]\n2     Alaska  8.963  17.6 47.951   47    445  489  934 (45,100]\n3    Arizona  4.778  19.3 32.175   27    448  496  944  (15,45]\n4   Arkansas  4.459  17.1 28.934    6    482  523 1005   (0,15]\n5 California  4.992  24.0 41.078   45    417  485  902  (15,45]\n6   Colorado  5.443  18.4 34.571   29    462  518  980  (15,45]\n\n\nA codebook is provided by Danny Kaplan who also made these data accessible:\n\nExercise 1: SAT scores\nPart a\nConstruct a plot of how the average sat scores vary from state to state. (Just use 1 variable – sat not State!)\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nggplot(education, aes(x=sat)) + geom_density()\n\n\n\n\n\n\n\nPart b\nSummarize your observations from the plot. Comment on the basics: range, typical outcomes, shape. (Any theories about what might explain this non-normal shape?)\nThe range is from 840 to 1110. Typical outcome is around 910 and 1030. Shape of the graph is two humps.\nExercise 2: SAT Scores vs Per Pupil Spending & SAT Scores vs Salaries\nThe first question we’d like to answer is: Can the variability in sat scores from state to state be partially explained by how much a state spends on education, specifically its per pupil spending (expend) and typical teacher salary?\nPart a\n\n# Construct a plot of sat vs expend\n# Include a \"best fit linear regression model\" (HINT: method = \"lm\")\nggplot(education, aes(x = sat, y = expend)) + geom_point() + geom_smooth(method = \"lm\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\n# Construct a plot of sat vs salary\n# Include a \"best fit linear regression model\" (HINT: method = \"lm\")\nggplot(education, aes(x = sat, y = salary)) + geom_point() + geom_smooth(method = \"lm\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\nPart b\nWhat are the relationship trends between SAT scores and spending? Is there anything that surprises you?\nNegative correlation between SAT score and spending/salary. It is surprising because higher teacher salary might indicate higher education quality?\nExercise 3: SAT Scores vs Per Pupil Spending and Teacher Salaries\nConstruct one visualization of the relationship of sat with salary and expend. HINT: Start with just 2 variables and tweak that code to add the third variable. Try out a few things!\n\nggplot(education, aes(x = sat, y = salary, size = expend)) + geom_point() + geom_smooth(method = \"lm\")\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\nWarning: The following aesthetics were dropped during statistical transformation: size.\nℹ This can happen when ggplot fails to infer the correct grouping structure in\n  the data.\nℹ Did you forget to specify a `group` aesthetic or to convert a numerical\n  variable into a factor?\n\n\n\n\n\n\n\n\nExercise 4: Another way to Incorporate Scale\nIt can be tough to distinguish color scales and size scales for quantitative variables. Another option is to discretize a quantitative variable, or basically cut it up into categories.\nConstruct the plot below. Check out the code and think about what’s happening here. What happens if you change “2” to “3”?\n\nggplot(education, aes(y = sat, x = salary, color = cut(expend, 3))) + \n  geom_point() + \n  geom_smooth(se = FALSE, method = \"lm\")\n\nDescribe the trivariate relationship between sat, salary, and expend.\nsat/salary is positively correlated to expend.\nExercise 5: Finally an Explanation\nIt’s strange that SAT scores seem to decrease with spending. But we’re leaving out an important variable from our analysis: the fraction of a state’s students that actually take the SAT. The fracCat variable indicates this fraction: low (under 15% take the SAT), medium (15-45% take the SAT), and high (at least 45% take the SAT).\nPart a\nBuild a univariate viz of fracCat to better understand how many states fall into each category.\n\nggplot(education, aes(x = fracCat)) + geom_bar()\n\n\n\n\n\n\n\nPart b\nBuild 2 bivariate visualizations that demonstrate the relationship between sat and fracCat. What story does your graphic tell and why does this make contextual sense?\n\nggplot(education, aes(x = fracCat, y = sat)) + geom_boxplot()\n\n\n\n\n\n\n\nSAT score is negatively correlated to the percentage of students who take SAT.\nPart c\nMake a trivariate visualization that demonstrates the relationship of sat with expend AND fracCat. Highlight the differences in fracCat groups through color AND unique trend lines. What story does your graphic tell?\nDoes it still seem that SAT scores decrease as spending increases?\n\nggplot(education, aes(x = expend, y = sat, color = fracCat)) + geom_point() + geom_smooth(method = \"lm\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\nPart d\nPutting all of this together, explain this example of Simpson’s Paradox. That is, why did it appear that SAT scores decrease as spending increases even though the opposite is true?\nBecause the percentage of students who take SAT is a very important and relevant factor of average SAT score, leaving it out would show the trend to be otherwise.",
    "crumbs": [
      "In-class Activities",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Mulivariate Viz</span>"
    ]
  },
  {
    "objectID": "ica/ica-multi.html#exercises-optional",
    "href": "ica/ica-multi.html#exercises-optional",
    "title": "\n13  Mulivariate Viz\n",
    "section": "\n13.2 Exercises (optional)",
    "text": "13.2 Exercises (optional)\nExercise 6: Heat Maps\nAs usual, we’ve only just scratched the surface! There are lots of other data viz techniques for exploring multivariate relationships. Let’s start with a heat map.\nPart a\nRun the chunks below. Check out the code, but don’t worry about every little detail! NOTES:\n\nThis is not part of the ggplot() grammar, making it a bit complicated.\nIf you’re curious about what a line in the plot does, comment it out (#) and check out what happens!\nIn the plot, for each state (row), each variable (column) is scaled to indicate whether the state has a relative high value (yellow), a relatively low value (purple), or something in between (blues/greens).\nYou can also play with the color scheme. Type ?cm.colors in the console to learn about various options.\nWe’ll improve the plot later, so don’t spend too much time trying to learn something from this plot.\n\n\n# Remove the \"State\" column and use it to label the rows\n# Then scale the variables\nplot_data &lt;- education |&gt; \n  column_to_rownames(\"State\") |&gt; \n  data.matrix() |&gt; \n  scale()\n\n# Load the gplots package needed for heatmaps\nlibrary(gplots)\n\n# Construct heatmap 1\nheatmap.2(plot_data,\n  dendrogram = \"none\",\n  Rowv = NA, \n  scale = \"column\",\n  keysize = 0.7, \n  density.info = \"none\",\n  col = hcl.colors(256), \n  margins = c(10, 20),\n  colsep = c(1:7), rowsep = (1:50), sepwidth = c(0.05, 0.05),\n  sepcolor = \"white\", trace = \"none\"\n)\n\n\n# Construct heatmap 2\nheatmap.2(plot_data,\n  dendrogram = \"none\",\n  Rowv = TRUE,             ### WE CHANGED THIS FROM NA TO TRUE\n  scale = \"column\",\n  keysize = 0.7, \n  density.info = \"none\",\n  col = hcl.colors(256), \n  margins = c(10, 20),\n  colsep = c(1:7), rowsep = (1:50), sepwidth = c(0.05, 0.05),\n  sepcolor = \"white\", trace = \"none\"\n)\n\n\n# Construct heatmap 3\nheatmap.2(plot_data,\n  dendrogram = \"row\",       ### WE CHANGED THIS FROM \"none\" TO \"row\"\n  Rowv = TRUE,            \n  scale = \"column\",\n  keysize = 0.7, \n  density.info = \"none\",\n  col = hcl.colors(256), \n  margins = c(10, 20),\n  colsep = c(1:7), rowsep = (1:50), sepwidth = c(0.05, 0.05),\n  sepcolor = \"white\", trace = \"none\"\n)\n\nPart b\nIn the final two plots, the states (rows) are rearranged by similarity with respect to these education metrics. The final plot includes a dendrogram which further indicates clusters of similar states. In short, states that have a shorter path to connection are more similar than others.\nPutting this all together, what insight do you gain about the education trends across U.S. states? Which states are similar? In what ways are they similar? Are there any outliers with respect to 1 or more of the education metrics?\nGeographically, the closer the states to each other, the more similiar their eductation. Minnesota, Wisconsin, Illinois are very similar to each other in terms of spending and sat etc, with Michigan being less similar. California and Utah have very high “ratio”.\nExercise 7: Star plots\nLike heat maps, star plots indicate the relative scale of each variable for each state. Thus, we can use star maps to identify similar groups of states, and unusual states!\nPart a\nConstruct and check out the star plot below. Note that each state has a “pie”, with each segment corresponding to a different variable. The larger a segment, the larger that variable’s value is in that state. For example:\n\nCheck out Minnesota. How does Minnesota’s education metrics compare to those in other states? What metrics are relatively high? Relatively low?\nWhat states appear to be similar? Do these observations agree with those that you gained from the heat map?\n\n\nstars(plot_data,\n  flip.labels = FALSE,\n  key.loc = c(10, 1.5),\n  cex = 1, \n  draw.segments = TRUE\n)\n\nPart b\nFinally, let’s plot the state stars by geographic location! What new insight do you gain here?!\n\nstars(plot_data,\n  flip.labels = FALSE,\n  locations = data.matrix(as.data.frame(state.center)),  # added external data to arrange by geo location\n  key.loc = c(-110, 28),\n  cex = 1, \n  draw.segments = TRUE\n)",
    "crumbs": [
      "In-class Activities",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Mulivariate Viz</span>"
    ]
  },
  {
    "objectID": "ica/ica-spatial.html",
    "href": "ica/ica-spatial.html",
    "title": "\n14  Spatial Viz\n",
    "section": "",
    "text": "14.1 Exercises",
    "crumbs": [
      "In-class Activities",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Spatial Viz</span>"
    ]
  },
  {
    "objectID": "ica/ica-spatial.html#exercises",
    "href": "ica/ica-spatial.html#exercises",
    "title": "\n14  Spatial Viz\n",
    "section": "",
    "text": "14.1.1 Preview\nYou’ll explore some R spatial viz tools below. In general, there are two important pieces to every map:\nPiece 1: A dataset\nThis dataset must include either:\n\nlocation coordinates for your points of interest (for point maps); or\nvariable outcomes for your regions of interest (for choropleth maps)\n\n\nPiece 2: A background map\nWe need latitude and longitude coordinates to specify the boundaries for your regions of interest (eg: countries, states). This is where it gets really sticky!\n\nCounty-level, state-level, country-level, continent-level info live in multiple places.\nWhere we grab this info can depend upon whether we want to make a point map or a choropleth map. (The background maps can be used somewhat interchangeably, but it requires extra code :/)\nWhere we grab this info can also depend upon the structure of our data and how much data wrangling / cleaning we’re up for. For choropleth maps, the labels of regions in our data must match those in the background map. For example, if our data labels states with their abbreviations (eg: MN) and the background map refers to them as full names in lower case (eg: minnesota), we have to wrangle our data so that it matches the background map.\n\nIn short, the code for spatial viz gets very specialized. The goal of these exercises is to:\n\nplay around and experience the wide variety of spatial viz tools out there\nunderstand the difference between point maps and choropleth maps\nhave fun\n\nYou can skip around as you wish and it’s totally fine if you don’t finish everything. Just come back at some point to play around.\nPart 1: Interactive points on a map with leaflet\n\nLeaflet is an open-source JavaScript library for creating maps. We can use it inside R through the leaflet package.\nThis uses a different plotting framework than ggplot2, but still has a tidyverse feel (which will become more clear as we learn other tidyverse tools!).\nThe general steps are as follows:\n\nCreate a map widget by calling leaflet() and telling it the data to use.\nAdd a base map using addTiles() (the default) or addProviderTiles().\nAdd layers to the map using layer functions (e.g. addMarkers(), addPolygons()).\nPrint the map widget to display it.\nExercise 1: A leaflet with markers / points\nEarlier this semester, I asked for the latitude and longitude of one of your favorite places. I rounded these to the nearest whole number, so that they’re near to but not exactly at those places. Let’s load the data and map it!\n\nfave_places &lt;- read.csv(\"https://hash-mac.github.io/stat112site-s25/data/our_fave_places.csv\")\n\n# Check it out\nhead(fave_places)\n\nPart a\nYou can use a “two-finger scroll” to zoom in and out.\n\n# Load the leaflet package\nlibrary(leaflet)\nfave_places &lt;- read.csv(\"https://hash-mac.github.io/stat112site-s25/data/our_fave_places.csv\")\n\n# Just a plotting frame\nleaflet(data = fave_places)\n\n\n\n\n\n\n# Now what do we have?\n# A world map\nleaflet(data = fave_places) |&gt; \n  addTiles()\n\n\n\n\n\n\n# Now what do we have?\n# longitude and latitude refer to the variables in our data\n# We have all dots from the data plotted on the map\nleaflet(data = fave_places) |&gt; \n  addTiles() |&gt; \n  addMarkers(lng = ~longitude, lat = ~latitude)\n\n\n\n\n\n\n# Since we named them \"longitude\" and \"latitude\", the function\n# automatically recognizes these variables. No need to write them!\nleaflet(data = fave_places) |&gt; \n  addTiles() |&gt; \n  addMarkers()\n\n\n\n\n\nPart b\nPLAY AROUND! This map is interactive. Zoom in on one location. Keep zooming – what level of detail can you get into? How does that detail depend upon where you try to zoom in (thus what are the limitations of this tool)?\nDetails go up to street and buildings which is very precise. The more populated the place, the more details. No detail on ocean.\nExercise 2: Details\nWe can change all sorts of details in leaflet maps.\n\n# Load package needed to change color\nlibrary(gplots)\n\n\nAttaching package: 'gplots'\n\n\nThe following object is masked from 'package:stats':\n\n    lowess\n\n# We can add colored circles instead of markers at each location\nleaflet(data = fave_places) |&gt; \n  addTiles() |&gt; \n  addCircles(color = col2hex(\"red\"))\n\n\n\n\n\n\n# We can change the background\n# Mark locations with yellow dots\n# And connect the dots, in their order in the dataset, with green lines\n# (These green lines don't mean anything here, but would if this were somebody's travel path!)\nleaflet(data = fave_places) |&gt;\n  addProviderTiles(\"USGS\") |&gt;\n  addCircles(weight = 10, opacity = 1, color = col2hex(\"yellow\")) |&gt;\n  addPolylines(\n    lng = ~longitude,\n    lat = ~latitude,\n    color = col2hex(\"green\")\n  )\n\n\n\n\n\nIn general:\n\naddProviderTiles() changes the base map.\nTo explore all available provider base maps, type providers in the console. (Though some don’t work :/)\n\nUse addMarkers() or addCircles() to mark locations. Type ?addControl into the console to pull up a help file which summarizes the aesthetics of these markers and how you can change them. For example:\n\n\nweight = how thick to make the lines, points, pixels\n\nopacity = transparency (like alpha in ggplot2)\ncolors need to be in “hex” form. We used the col2hex() function from the gplots library to do that\n\n\nExercise 3: Your turn\nThe starbucks data, compiled by Danny Kaplan, contains information about every Starbucks in the world at the time the data were collected, including Latitude and Longitude:\n\n# Import starbucks location data\nstarbucks &lt;- read.csv(\"https://mac-stat.github.io/data/starbucks.csv\")\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\n\nLet’s focus on only those in Minnesota for now:\n\n# Don't worry about the syntax\nstarbucks_mn &lt;- starbucks |&gt;   \n  filter(Country == \"US\", State.Province == \"MN\")\n\nCreate a leaflet map of the Starbucks locations in Minnesota.\n\nleaflet(data = starbucks_mn) |&gt; \n  addTiles() |&gt; \n  addMarkers()\n\nAssuming \"Longitude\" and \"Latitude\" are longitude and latitude, respectively\n\n\n\n\n\n\nKeep it simple – go back to Exercise 1 for an example.\nPart 2: Static points on a map\nLeaflet is very powerful and fun. But:\n\nIt’s not great when we have lots of points to map – it takes lots of time.\nIt makes good interactive maps, but we often need a static map (eg: we can not print interactive maps!).\n\nLet’s explore how to make point maps with ggplot(), not leaflet().\nExercise 3: A simple scatterplot\nLet’s start with the ggplot() tools we already know. Construct a scatterplot of all starbucks locations, not just those in Minnesota, with:\n\nLatitude and Longitude coordinates (which goes on the y-axis?!)\nMake the points transparent (alpha = 0.2) and smaller (size = 0.2)\n\nIt’s pretty cool that the plots we already know can provide some spatial context. But what don’t you like about this plot?\nThere’s no map\n\nggplot(starbucks, aes(x = Longitude, y = Latitude)) + geom_point(alpha = 0.2, size = 0.2)\n\nWarning: Removed 1 row containing missing values or values outside the scale range\n(`geom_point()`).\n\n\n\n\n\n\n\n\nExercise 4: Adding a country-level background\nLet’s add a background map of country-level boundaries.\nPart a\nFirst, we can grab country-level boundaries from the rnaturalearth package.\n\n# Load the package\nlibrary(rnaturalearth)\n\n# Get info about country boundaries across the world\n# in a \"sf\" or simple feature format\nworld_boundaries &lt;- ne_countries(returnclass = \"sf\")\n\nIn your console, type world_boundaries to check out what’s stored there. Don’t print it our in your Rmd – printing it would be really messy there (even just the head()).\nPart b\nRun the chunks below to build up a new map.\n\n# What does this code produce?\n# What geom are we using for the point map?\n# A world map. geom_sf()\nggplot(world_boundaries) + \n  geom_sf()\n\n\n\n\n\n\n\n\n# Load package needed to change map theme\nlibrary(mosaic)\n\nRegistered S3 method overwritten by 'mosaic':\n  method                           from   \n  fortify.SpatialPolygonsDataFrame ggplot2\n\n\n\nThe 'mosaic' package masks several functions from core packages in order to add \nadditional features.  The original behavior of these functions should not be affected by this.\n\n\n\nAttaching package: 'mosaic'\n\n\nThe following object is masked from 'package:Matrix':\n\n    mean\n\n\nThe following objects are masked from 'package:dplyr':\n\n    count, do, tally\n\n\nThe following object is masked from 'package:purrr':\n\n    cross\n\n\nThe following object is masked from 'package:ggplot2':\n\n    stat\n\n\nThe following objects are masked from 'package:stats':\n\n    binom.test, cor, cor.test, cov, fivenum, IQR, median, prop.test,\n    quantile, sd, t.test, var\n\n\nThe following objects are masked from 'package:base':\n\n    max, mean, min, prod, range, sample, sum\n\n# Add a point for each Starbucks\n# NOTE: The Starbucks info is in our starbucks data, not world_boundaries\n# How does this change how we use geom_point?!\n# We plot point inside of the ggplot of world_boundaries instead of separately\nggplot(world_boundaries) + \n  geom_sf() + \n  geom_point(\n    data = starbucks,\n    aes(x = Longitude, y = Latitude),\n    alpha = 0.3, size = 0.2, color = \"darkgreen\"\n  ) +\n  theme_map()\n\nWarning: Removed 1 row containing missing values or values outside the scale range\n(`geom_point()`).\n\n\n\n\n\n\n\n\nPart c\nSummarize what you learned about Starbucks from this map.\nStarbucks are very concentrated in North America, East & SE Asia, and some of Europe. Few location in South America. No Starbucks in Italy. No Starbucks in Antartica, bummer:(\nExercise 5: Zooming in on some countries\nInstead of world_boundaries &lt;- ne_countries(returnclass = 'sf') we could zoom in on…\n\nthe continent of Africa: ne_countries(continent = 'Africa', returnclass = 'sf')\n\na set of countries: ne_countries(country = c('france', 'united kingdom', 'germany'), returnclass = 'sf')\n\nboundaries within a country: ne_states(country = 'united states of america', returnclass = 'sf')\n\n\nOur goal here will be to map the Starbucks locations in Canada, Mexico, and the US.\nPart a\nTo make this map, we again need two pieces of information.\n\nData on Starbucks for only Canada, Mexico, and the US, labeled as “CA”, “MX”, “US” in the starbucks data.\n\n\n# We'll learn this syntax soon! Don't worry about it now.\nstarbucks_cma &lt;- starbucks |&gt; \n  filter(Country %in% c('CA', 'MX', 'US'))\n\n\nA background map of state- and national-level boundaries in Canada, Mexico, and the US. This requires ne_states() in the rnaturalearth package where the countries are labeled ‘canada’, ‘mexico’, ‘united states of america’.\n\n\ncma_boundaries &lt;- ne_states(\n  country = c(\"canada\", \"mexico\", \"united states of america\"),\n  returnclass = \"sf\")\n\nPart b\nMake the map!\n\n# Just the boundaries\nggplot(cma_boundaries) + \n  geom_sf()\n\n\n\n\n\n\n\n\n# Add the points\n# And zoom in\nggplot(cma_boundaries) + \n  geom_sf() + \n  geom_point(\n    data = starbucks_cma,\n    aes(x = Longitude, y = Latitude),\n    alpha = 0.3,\n    size = 0.2,\n    color = \"darkgreen\"\n  ) +\n  coord_sf(xlim = c(-179.14, -50)) +\n  theme_map()\n\n\n\n\n\n\n\nExercise 6: A state and county-level map\nLet’s get an even higher resolution map of Starbucks locations within the states of Minnesota, Wisconsin, North Dakota, and South Dakota, with a background map at the county-level.\nPart a\nTo make this map, we again need two pieces of information.\n\nData on Starbucks for only the states of interest.\n\n\nstarbucks_midwest &lt;- starbucks |&gt; \n  filter(State.Province %in% c(\"MN\", \"ND\", \"SD\", \"WI\"))\n\n\nA background map of state- and county-level boundaries in these states. This requires st_as_sf() in the sf package, and map() in the maps package, where the countries are labeled ‘minnesota’, ‘north dakota’, etc.\n\n\n# Load packages\nlibrary(sf)\n\nLinking to GEOS 3.13.0, GDAL 3.10.1, PROJ 9.5.1; sf_use_s2() is TRUE\n\nlibrary(maps)\n\n\nAttaching package: 'maps'\n\n\nThe following object is masked from 'package:purrr':\n\n    map\n\n# Get the boundaries\nmidwest_boundaries &lt;- st_as_sf(\n  maps::map(\"county\",\n            region = c(\"minnesota\", \"wisconsin\", \"north dakota\", \"south dakota\"), \n            fill = TRUE, plot = FALSE))\n\n# Check it out\nhead(midwest_boundaries)\n\nSimple feature collection with 6 features and 1 field\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: -96.81268 ymin: 45.05167 xmax: -93.01397 ymax: 48.53526\nGeodetic CRS:  +proj=longlat +ellps=clrk66 +no_defs +type=crs\n                                     ID                           geom\nminnesota,aitkin       minnesota,aitkin MULTIPOLYGON (((-93.03689 4...\nminnesota,anoka         minnesota,anoka MULTIPOLYGON (((-93.51817 4...\nminnesota,becker       minnesota,becker MULTIPOLYGON (((-95.14537 4...\nminnesota,beltrami   minnesota,beltrami MULTIPOLYGON (((-95.58655 4...\nminnesota,benton       minnesota,benton MULTIPOLYGON (((-93.77027 4...\nminnesota,big stone minnesota,big stone MULTIPOLYGON (((-96.10794 4...\n\n\nPart b\nAdjust the code below to make the plot! Remove the # to run it.\n\n ggplot(midwest_boundaries) + \n   geom_sf() + \n   geom_point(\n     data = starbucks_midwest,\n     aes(x = Longitude, y = Latitude),\n     alpha = 0.7,\n     size = 0.2, \n     color = 'darkgreen'\n   ) + \n   theme_map()\n\n\n\n\n\n\n\nExercise 7: Contour maps\nEspecially when there are lots of point locations, and those locations start overlapping on a map, it can be tough to visualize areas of higher density. Consider the Starbucks locations in Canada, Mexico, and the US that we mapped earlier:\n\n# Point map (we made this earlier)\nggplot(cma_boundaries) + \n  geom_sf() + \n  geom_point(\n    data = starbucks_cma,\n    aes(x = Longitude, y = Latitude),\n    alpha = 0.3,\n    size = 0.2,\n    color = \"darkgreen\"\n  ) +\n  coord_sf(xlim = c(-179.14, -50), ylim = c(14.54, 83.11)) +\n  theme_map()\n\n\n\n\n\n\n\nNow check out the contour map.\n\n# The points became contours.\n# geom_point() became geom_23\nggplot(cma_boundaries) + \n  geom_sf() + \n  geom_density_2d(\n    data = starbucks_cma,\n    aes(x = Longitude, y = Latitude),\n    size = 0.2,\n    color = \"darkgreen\"\n  ) +\n  coord_sf(xlim = c(-179.14, -50), ylim = c(14.54, 83.11)) +\n  theme_map()\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n\n\n\n\n\n\n\n\nPart 3: Choropleth maps\nSpatial data isn’t always in the form of point locations! For example, recall the state and county-level data on presidential elections.\n\nelections_by_state &lt;-  read.csv(\"https://mac-stat.github.io/data/election_2020_by_state.csv\")\nelections_by_counties &lt;- read.csv(\"https://mac-stat.github.io/data/election_2020_county.csv\")\n\nIn these datasets, we’re interested in the overall election outcome by region (state or county), not the specific geographic location of some observation. Let’s wrangle our data first. We’ll focus on just a few variables of interest, and create a new variable (repub_20_categories) that discretizes the repub_pct_20 variable into increments of 5 percentage points (for states) or 10 percentage points (for counties):\n\n# Don't worry about the code!\n\nelections_by_state &lt;- elections_by_state |&gt; \n  filter(state_abbr != \"DC\") |&gt; \n  select(state_name, state_abbr, repub_pct_20) |&gt; \n  mutate(repub_20_categories = \n           cut(repub_pct_20, \n               breaks = seq(30, 70, by = 5), \n               labels = c(\"30-34\", \"35-39\", \"40-44\", \"45-49\",\n                          \"50-54\", \"55-59\", \"60-64\", \"65-70\"), \n               include.lowest = TRUE))\n\nelections_by_counties &lt;- elections_by_counties |&gt; \n  select(state_name, state_abbr, county_name, county_fips,\n          repub_pct_20, median_age, median_rent) |&gt; \n  mutate(repub_20_categories = \n           cut(repub_pct_20, \n               breaks = seq(0, 100, by = 10),\n               labels = c(\"0-9\", \"10-19\", \"20-29\", \"30-39\", \"40-49\",\n                          \"50-59\", \"60-69\", \"70-79\", \"80-89\", \"90-100\"),\n               include.lowest = TRUE))\n\nExercise 8: State-level choropleth maps\nLet’s map the 2020 Republican support in each state, repub_pct_20.\nPart a\nWe again need two pieces of information.\n\nData on elections in each state, which we already have: elections_by_state.\nA background map of state boundaries in the US. The boundaries we used for point maps don’t work here. (Optional detail: they’re sf objects and we now need a data.frame object.) Instead, we can use the map_data() function from the ggplot2 package:\n\n\n# Get the latitude and longitude coordinates of state boundaries\nstates_map &lt;- map_data(\"state\")\n\n# Check it out\nhead(states_map)\n\n       long      lat group order  region subregion\n1 -87.46201 30.38968     1     1 alabama      &lt;NA&gt;\n2 -87.48493 30.37249     1     2 alabama      &lt;NA&gt;\n3 -87.52503 30.37249     1     3 alabama      &lt;NA&gt;\n4 -87.53076 30.33239     1     4 alabama      &lt;NA&gt;\n5 -87.57087 30.32665     1     5 alabama      &lt;NA&gt;\n6 -87.58806 30.32665     1     6 alabama      &lt;NA&gt;\n\n\nPause\nImportant detail: Note that the region variable in states_map, and the state_name variable in elections_by_state both label states by the full name in lower case letters. This is critical to the background map and our data being able to communicate.\n\nhead(states_map)\n\n       long      lat group order  region subregion\n1 -87.46201 30.38968     1     1 alabama      &lt;NA&gt;\n2 -87.48493 30.37249     1     2 alabama      &lt;NA&gt;\n3 -87.52503 30.37249     1     3 alabama      &lt;NA&gt;\n4 -87.53076 30.33239     1     4 alabama      &lt;NA&gt;\n5 -87.57087 30.32665     1     5 alabama      &lt;NA&gt;\n6 -87.58806 30.32665     1     6 alabama      &lt;NA&gt;\n\nhead(elections_by_state) \n\n   state_name state_abbr repub_pct_20 repub_20_categories\n1     alabama         AL        62.03               60-64\n2    arkansas         AR        62.40               60-64\n3     arizona         AZ        49.06               45-49\n4  california         CA        34.33               30-34\n5    colorado         CO        41.90               40-44\n6 connecticut         CT        39.21               35-39\n\n\nPart b\nNow map repub_pct_20 by state.\n\n# Note where the dataset, elections_by_state, is used\n# Note where the background map, states_map, is used\nggplot(elections_by_state, aes(map_id = state_name, fill = repub_pct_20)) +\n  geom_map(map = states_map) +\n  expand_limits(x = states_map$long, y = states_map$lat) +\n  theme_map() \n\n\n\n\n\n\n\n\n# Make it nicer!\nggplot(elections_by_state, aes(map_id = state_name, fill = repub_pct_20)) +\n  geom_map(map = states_map) +\n  expand_limits(x = states_map$long, y = states_map$lat) +\n  theme_map() + \n  scale_fill_gradientn(name = \"% Republican\", colors = c(\"blue\", \"purple\", \"red\"), values = scales::rescale(seq(0, 100, by = 5)))\n\n\n\n\n\n\n\nIt’s not easy to get fine control over the color scale for the quantitative repub_pct_20 variable. Instead, let’s plot the discretized version, repub_20_categories:\n\nggplot(elections_by_state, aes(map_id = state_name, fill = repub_20_categories)) +\n  geom_map(map = states_map) +\n  expand_limits(x = states_map$long, y = states_map$lat) +\n  theme_map()\n\n\n\n\n\n\n\n\n# Load package needed for refining color palette\nlibrary(RColorBrewer)\n\n# Now fix the colors\nggplot(elections_by_state, aes(map_id = state_name, fill = repub_20_categories)) +\n  geom_map(map = states_map) +\n  expand_limits(x = states_map$long, y = states_map$lat) +\n  theme_map() + \n  scale_fill_manual(values = rev(brewer.pal(8, \"RdBu\")), name = \"% Republican\")\n\n\n\n\n\n\n\nPart c\nWe can add other layers, like points, on top of a choropleth map. Add a Starbucks layer! Do you notice any relationship between Starbucks and elections? Or are we just doing things at this point?\n;)\n\n# Get only the starbucks data from the US\nstarbucks_us &lt;- starbucks |&gt; \n  filter(Country == \"US\")\n\n# Map it\nggplot(elections_by_state, aes(map_id = state_name, fill = repub_20_categories)) +\n  geom_map(map = states_map) +\n  geom_point(\n    data = starbucks_us,\n    aes(x = Longitude, y = Latitude),\n    size = 0.05,\n    alpha = 0.2,\n    inherit.aes = FALSE\n  ) +\n  expand_limits(x = states_map$long, y = states_map$lat) +\n  theme_map() + \n  scale_fill_manual(values = rev(brewer.pal(8, \"RdBu\")), name = \"% Republican\")\n\n\n\n\n\n\n\nDetails (if you’re curious)\n\n\nmap_id is a required aesthetic for geom_map().\n\nIt specifies which variable in our dataset indicates the region (here state_name).\nIt connects this variable (state_name) to the region variable in our mapping background (states_map). These variables must have the same possible outcomes in order to be matched up (alabama, alaska, arizona,…).\n\n\n\nexpand_limits() assures that the map covers the entire area it’s supposed to, by pulling longitudes and latitudes from the states_map.\nPart d\nWe used geom_sf() for point maps. What geom do we use for choropleth maps?\ngeom_map()\nExercise 9: County-level choropleth maps\nLet’s map the 2020 Republican support in each county.\nPart a\nWe again need two pieces of information.\n\nData on elections in each county, which we already have: elections_by_county.\nA background map of county boundaries in the US, stored in the county_map dataset in the socviz package:\n\n\n# Get the latitude and longitude coordinates of county boundaries\nlibrary(socviz)\ndata(county_map) \n\n# Check it out\nhead(county_map)\n\n     long      lat order  hole piece            group    id\n1 1225889 -1275020     1 FALSE     1 0500000US01001.1 01001\n2 1235324 -1274008     2 FALSE     1 0500000US01001.1 01001\n3 1244873 -1272331     3 FALSE     1 0500000US01001.1 01001\n4 1244129 -1267515     4 FALSE     1 0500000US01001.1 01001\n5 1272010 -1262889     5 FALSE     1 0500000US01001.1 01001\n6 1276797 -1295514     6 FALSE     1 0500000US01001.1 01001\n\n\nPause\nImportant detail: We officially have a headache. Our county_map refers to each county by a 5-number id. Our elections_by_counties data refers to each county by a county_fips code, which is mostly the same as id, BUT drops any 0’s at the beginning of the code.\n\nhead(county_map)\n\n     long      lat order  hole piece            group    id\n1 1225889 -1275020     1 FALSE     1 0500000US01001.1 01001\n2 1235324 -1274008     2 FALSE     1 0500000US01001.1 01001\n3 1244873 -1272331     3 FALSE     1 0500000US01001.1 01001\n4 1244129 -1267515     4 FALSE     1 0500000US01001.1 01001\n5 1272010 -1262889     5 FALSE     1 0500000US01001.1 01001\n6 1276797 -1295514     6 FALSE     1 0500000US01001.1 01001\n\nhead(elections_by_counties)\n\n  state_name state_abbr    county_name county_fips repub_pct_20 median_age\n1    Alabama         AL Autauga County        1001        71.44       37.5\n2    Alabama         AL Baldwin County        1003        76.17       41.5\n3    Alabama         AL Barbour County        1005        53.45       38.3\n4    Alabama         AL    Bibb County        1007        78.43       39.4\n5    Alabama         AL  Blount County        1009        89.57       39.6\n6    Alabama         AL Bullock County        1011        24.84       39.6\n  median_rent repub_20_categories\n1         668               70-79\n2         693               70-79\n3         382               50-59\n4         351               70-79\n5         403               80-89\n6         276               20-29\n\n\nThis just means that we have to wrangle the data so that it can communicate with the background map.\n\n# Add 0's at the beginning of any fips_code that's fewer than 5 numbers long\n# Don't worry about the syntax\nelections_by_counties &lt;- elections_by_counties |&gt; \n  mutate(county_fips = as.character(county_fips)) |&gt; \n  mutate(county_fips = \n           ifelse(nchar(county_fips) == 4, paste0(\"0\", county_fips), county_fips))\n\nPart b\nNow map Republican support by county. Let’s go straight to the discretized repub_20_categories variable, and a good color scale.\n\nggplot(elections_by_counties, aes(map_id = county_fips, fill = repub_20_categories)) +\n  geom_map(map = county_map) +\n  scale_fill_manual(values = rev(brewer.pal(10, \"RdBu\")), name = \"% Republican\") +\n  expand_limits(x = county_map$long, y = county_map$lat) +\n  theme_map() +\n  theme(legend.position = \"right\") + \n  coord_equal()\n\n\n\n\n\n\n\nExercise 10: Play around!\nConstruct county-level maps of median_rent and median_age.\n\nggplot(elections_by_counties, aes(map_id = county_fips, fill = median_rent)) +\n  geom_map(map = county_map) +\n  scale_fill_gradient(low = \"red\", high = \"yellow\", name = \"Median Rent\") +\n  expand_limits(x = county_map$long, y = county_map$lat) +\n  theme_map() +\n  theme(legend.position = \"right\") + \n  coord_equal()\n\n\n\n\n\n\n\n\nggplot(elections_by_counties, aes(map_id = county_fips, fill = median_age)) +\n  geom_map(map = county_map) +\n  scale_fill_gradient(low = \"red\", high = \"yellow\", name = \"Median Age\") +\n  expand_limits(x = county_map$long, y = county_map$lat) +\n  theme_map() +\n  theme(legend.position = \"right\") + \n  coord_equal()\n\n\n\n\n\n\n\nExercise 11: Choropleth maps with leaflet\nThough ggplot() is often better for this purpose, we can also make choropleth maps with leaflet(). If you’re curious, check out the leaflet documentation:\nhttps://rstudio.github.io/leaflet/choropleths.html",
    "crumbs": [
      "In-class Activities",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Spatial Viz</span>"
    ]
  },
  {
    "objectID": "ica/ica-effective.html",
    "href": "ica/ica-effective.html",
    "title": "\n15  Effective Viz\n",
    "section": "",
    "text": "15.1 Exercises",
    "crumbs": [
      "In-class Activities",
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Effective Viz</span>"
    ]
  },
  {
    "objectID": "ica/ica-effective.html#exercises",
    "href": "ica/ica-effective.html#exercises",
    "title": "\n15  Effective Viz\n",
    "section": "",
    "text": "Exercise 1: Professionalism\nLet’s examine weather in 3 Australian locations.\n\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\n\nThe following plot is fine for things like homework or just playing around. But we’ll make it more “professional” looking below.\n\nggplot(weather, aes(y = temp3pm, x = temp9am, color = location)) + \n  geom_point()\n\nWarning: Removed 27 rows containing missing values or values outside the scale range\n(`geom_point()`).\n\n\n\n\n\n\n\n\nPart a\nReplace A, B, C, and D in the code below to:\n\nAdd a short, but descriptive title. Under 10 words.\nChange the x- and y-axis labels, currently just the names of the variables in the dataset. These should be short and include units.\nChange the legend title to “Location” (just for practice, not because it’s better than “location”).\n\n\nggplot(weather, aes(y = temp3pm, x = temp9am, color = location)) + \n  geom_point() + \n  labs(x = \"9 AM Temperature (°C)\", y = \"3 PM Temperature (°C)\", title = \"Temperature at 9AM and 3PM at same location\", color = \"Legend\")\n\nWarning: Removed 27 rows containing missing values or values outside the scale range\n(`geom_point()`).\n\n\n\n\n\n\n\n\nPart b\nWhen we’re including our plot in an article, paper, book, or other similar outlet, we should (and are expected to) provide a more descriptive figure caption. Typically, this is instead of a title and is more descriptive of what exactly is being plotted.\n\nAdd a figure caption in the top of the chunk.\nInclude your x-axis, y-axis, and legend labels from Part a.\nRender your Rmd and check out how the figure caption appears.\n\n\nggplot(weather, aes(y = temp3pm, x = temp9am, color = location, size = rainfall)) + \n  geom_point() + \n  labs(x = \"9 AM Temperature (°C)\", y = \"3 PM Temperature (°C)\", color = \"Island\", size = \"Rainfall (mm)\")  \n\nWarning: Removed 69 rows containing missing values or values outside the scale range\n(`geom_point()`).\n\n\n\n\nTemperature at 9AM and 3PM shows positive correlation\n\n\n\n\nExercise 2: Accessibility\nLet’s now make a graphic more accessible.\n\nggplot(weather, aes(x = temp3pm, fill = location)) + \n  geom_density(alpha = 0.5) + \n  labs(x = \"3pm temperature (Celsius)\")  \n\nWarning: Removed 19 rows containing non-finite outside the scale range\n(`stat_density()`).\n\n\n\n\nDensity plots of 3pm temperatures in 3 Australian locations.\n\n\n\nPart a\nLet’s add some alt text that can be picked up by screen readers. This is a great resource on writing alt text for data viz. In short, whereas figure captions are quick descriptions which assume that the viz is accessible, alt text is a longer description which assumes the viz is not accessible. Alt text should concisely articulate:\n\nWhat your visualization is (e.g. a density plot of 3pm temperatures in Hobart, Uluru, and Wollongong, Australia).\nA 1-sentence description of the most important takeaway.\nA link to your data source if it’s not already in the caption.\n\nAdd appropriate alt text at the top of the chunk, in fig-alt. Then knit your Rmd, and hover over the image in your knitted html file to check out the alt text.\n\nggplot(weather, aes(x = temp3pm, fill = location)) + \n  geom_density(alpha = 0.5) + \n  labs(x = \"3pm temperature (Celsius)\")  \n\nWarning: Removed 19 rows containing non-finite outside the scale range\n(`stat_density()`).\n\n\n\n\nDensity plots of 3pm temperatures in 3 Australian locations.\n\n\n\n\nPart b\nColor is another important accessibility consideration. Let’s check out the color accessibility of our density plot.\n\nRun the ggplot() code from Part a in your console. The viz will pop up in the Plots tab.\nIn the Plots tab, click “Export” then “Save as image”. Save the image somewhere.\nNavigate to https://www.color-blindness.com/coblis-color-blindness-simulator/\n\nAbove the image of crayons (I think it’s crayons?), click “Choose file” and choose the plot file you just saved.\nClick the various simulator buttons (eg: Red-Weak/Protanomaly) to check out how the colors in this plot might appear to others.\nSummarize what you learn. What impact might our color choices have on one’s ability to interpret the viz?\n\nFor color weakness, color scale might affect the understanding. For one-color blindness, inappropriate color scale can be confusing. We shall use color scales that are friendly to colorblind people.\nPart c\nWe can change our color schemes! There are many color-blind friendly palettes in R. In the future, we’ll set a default, more color-blind friendly color theme at the top of our Rmds. We can also do this individually for any plot that uses color. Run the chunks below to explore various options.\n\nggplot(weather, aes(x = temp3pm, fill = location)) + \n  geom_density(alpha = 0.5) + \n  labs(x = \"3pm temperature (Celsius)\") + \n  scale_fill_viridis_d()    \n\nWarning: Removed 19 rows containing non-finite outside the scale range\n(`stat_density()`).\n\n\n\n\n\n\n\n\n\n# In the color scale line:\n# Change \"fill\" to \"color\" since we use color in the aes()\n# Change \"d\" (discrete) to \"c\" (continuous) since maxtemp is on a continuous scale\nggplot(weather, aes(y = temp3pm, x = temp9am, color = maxtemp)) + \n  geom_point(alpha = 0.5) + \n  labs(x = \"3pm temperature (Celsius)\") + \n  scale_color_viridis_c()\n\nWarning: Removed 27 rows containing missing values or values outside the scale range\n(`geom_point()`).\n\n\n\n\n\n\n\n\n\nExercise 3: Ethics\nLet’s scratch the surface of ethics in data viz. Central to this discussion is the consideration of impact.\nPart a\nAt a minimum, our data viz should not mislead. Reconsider the climate change example from above. Why is this plot unethical and what impact might it have on policy, public opinion, etc?\n\nPart b\nAgain, data viz ethical considerations go beyond whether or not a plot is misleading. As described in the warm-up, we need to consider: visibility, privacy, power, emotion & embodiment, pluralism, & context. Depending upon the audience and goals of a data viz, addressing these points might require more nuance. Mainly, the viz tools we’ve learned are a great base or foundation, but aren’t the only approaches to data viz. \nPick one or more of the following examples of data viz to discuss with your group. How do the approaches taken:\n\nemphasize one or more of: visibility, privacy, power, emotion, embodiment, pluralism, and/or context?\nimprove upon what we might be able to convey with a simpler bar chart, scatterplot, etc?\n\n\nExample: W.E.B. Du Bois (1868–1963)\nDu Bois (“Doo Boys”) was a “sociologist, socialist, historian, civil rights activist, Pan-Africanist, author, writer, and editor”1. He was also a pioneer in elevating emotion and embodiment in data visualization. For the Paris World Fair of 1900, Du Bois and his team of students from Atlanta University presented 60 data visualizations of the Black experience in America, less than 50 years after the abolishment of slavery. Du Bois noted: “I wanted to set down its aim and method in some outstanding way which would bring my work to notice by the thinking world.” That is, he wanted to increase the impact of his work by partnering technical visualizations with design that better connects to lived experiences. NOTE: This work uses language common to that time period and addresses the topic of slavery. Check out:\n\nA complete set of the data visualizations provided by Anthony Starks (@ajstarks).\nAn article by Allen Hillery (@AlDatavizguy).\n\n\nExample: One person’s experience with long COVID\nNYT article\n\nExample: Decolonizing data viz\nblog post\n\nExample: Visualizing climate change through art\nFutures North with Prof John Kim & Mac students (by Prof Kim, Mac research students)\n\nExample: Personal data collection\nDear Data\n\nPart c\nFor a deeper treatment of similar topics, and more examples, read Data Feminism.\n\nExercise 4: Critique\nPractice critiquing some more complicated data viz listed at Modern Data Science with R, Exercise 2.5.\nThink about the following questions:\n\nWhat story does the data graphic tell? What is the main message that you take away from it?\nCan the data graphic be described in terms of the Grammar of Graphics (frame, glyphs, aesthetics, facet, scale, guide)? If so, please describe.\nCritique and/or praise the visualization choices made by the designer. Do they work? Are they misleading? Thought-provoking? Are there things that you would have done differently?\n\n\nExercise 5: Design Details\nThis final exercise is just “food for thought”. It’s more of a discussion than an exercise, and gets into some of the finer design details and data viz theory. Go as deep or not deep as you’d like here.\nIn refining the details of our data viz, Visualize This and Storytelling with Data provide some of their guiding principles. But again, every context is different.\n\nPut yourself in a reader’s shoes. What parts of the data need explanation?\nShine a light on your data. Try to remove any “chart junk” that distracts from the data.\nVary color and style to emphasize the viz elements that are most important to the story you’re telling.\nIt is easier to judge length than it is to judge area or angles.\nBe thoughtful about how your categories are ordered for categorical data.\n\nGetting into even more of the nitty gritty, we need to be mindful of what geometric elements and aesthetics we use. The following elements/aesthetics are listed in roughly descending order of human ability to perceive and compare nearby objects:2\n\nPosition\nLength\nAngle\nDirection\nShape (but only a very few different shapes)\nArea\nVolume\nShade\nColor. (Color is the most difficult, because it is a 3-dimensional quantity.)\n\nFinally, here are some facts to keep in mind about visual perception from Now You See It.\nPart a: Selectivity\nVisual perception is selective, and our attention is often drawn to contrasts from the norm.\nImplication: We should design visualizations so that the features we want to highlight stand out in contrast from those that are not worth the audience’s attention.\nExample: What stands out in this example image? This is originally from C. Ware, Information Visualization: Perception for Design, 2004? Source: S. Few, Now You See It, 2009, p. 33.\n\nPart b: Familiarity\nOur eyes are drawn to familiar patterns. We observe what we know and expect.\nImplication: Visualizations work best when they display information as patterns that familiar and easy to spot.\nExample: Do you notice anything embedded in this rose image from coolbubble.com? Source: S. Few, Now You See It, 2009, p. 34.\n\nPart c: Revisit\nRevisit Part b. Do you notice anything in the shadows? Go to https://mac-stat.github.io/images/112/rose2.png for an image.\n\nWrapping up\nIf you finish early:\n\nWork on homework if not done already\nComplete any activities you haven’t finished yet, eg, spatial viz, the optional but fun exercises in the Multivariate viz and Bivariate viz activities.\nIf you’ve done all that, explore some datasets in TidyTuesday.",
    "crumbs": [
      "In-class Activities",
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Effective Viz</span>"
    ]
  },
  {
    "objectID": "ica/ica-effective.html#footnotes",
    "href": "ica/ica-effective.html#footnotes",
    "title": "\n15  Effective Viz\n",
    "section": "",
    "text": "https://en.wikipedia.org/wiki/W._E._B._Du_Bois↩︎\nB. S. Baumer, D. T. Kaplan, and N. J. Horton, Modern Data Science with R, 2017, p. 15.↩︎",
    "crumbs": [
      "In-class Activities",
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Effective Viz</span>"
    ]
  },
  {
    "objectID": "ica/ica-wrangling.html",
    "href": "ica/ica-wrangling.html",
    "title": "\n16  Wrangling\n",
    "section": "",
    "text": "library(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nelections &lt;- read.csv(\"https://mac-stat.github.io/data/election_2020_county.csv\")\n\nExercise 1: select Practice\nUse select() to create a simplified dataset that we’ll use throughout the exercises below.\n\nStore this dataset as elections_small.\nOnly keep the following variables: state_name, county_name, total_votes_20, repub_pct_20, dem_pct_20, total_votes_16, dem_pct_16\n\n\n\n# Define elections_small\nelections_small &lt;- elections |&gt;\n    select(state_name, county_name, total_votes_20, repub_pct_20, dem_pct_20, total_votes_16, dem_pct_16)\n\n# Check out the first 6 rows to confirm your code did what you think it did!\nhead(elections_small, 6)\n\n  state_name    county_name total_votes_20 repub_pct_20 dem_pct_20\n1    Alabama Autauga County          27770        71.44      27.02\n2    Alabama Baldwin County         109679        76.17      22.41\n3    Alabama Barbour County          10518        53.45      45.79\n4    Alabama    Bibb County           9595        78.43      20.70\n5    Alabama  Blount County          27588        89.57       9.57\n6    Alabama Bullock County           4613        24.84      74.70\n  total_votes_16 dem_pct_16\n1          24661      23.96\n2          94090      19.57\n3          10390      46.66\n4           8748      21.42\n5          25384       8.47\n6           4701      75.09\n\n\nExercise 2: filter Demo\nWhereas select() selects certain variables or columns, filter() keeps certain units of observation or rows relative to their outcome on certain variables. To this end, we must:\n\nIdentify the variable(s) that are relevant to the filter.\n\nUse a “logical comparison operator” to define which values of the variable to keep:\n\n\nsymbol\nmeaning\n\n\n\n==\nequal to\n\n\n!=\nnot equal to\n\n\n&gt;\ngreater than\n\n\n&gt;=\ngreater than or equal to\n\n\n&lt;\nless than\n\n\n&lt;=\nless than or equal to\n\n\n%in% c(???, ???)\na list of multiple values\n\n\n\n\nUse quotes \"\" when specifying outcomes of interest for a categorical variable.\n\n\n\n\n\n\n\nCommenting/Uncommenting Code\n\n\n\nTo comment/uncomment several lines of code at once, highlight them then click ctrl/cmd+shift+c.\n\n\n\n# Keep only data on counties in Hawaii\nelections_small |&gt;\n filter(state_name == \"Hawaii\")\n\n  state_name     county_name total_votes_20 repub_pct_20 dem_pct_20\n1     Hawaii   Hawaii County          87814        30.63      66.88\n2     Hawaii Honolulu County         382114        35.66      62.51\n3     Hawaii    Kauai County          33497        34.58      63.36\n4     Hawaii     Maui County          71044        31.14      66.59\n  total_votes_16 dem_pct_16\n1          64865      63.61\n2         285683      61.48\n3          26335      62.49\n4          51942      64.45\n\n\n\n# What does this do?\n# It keeps only state of Delaware and Hawaii.\nelections_small |&gt;\n  filter(state_name %in% c(\"Hawaii\", \"Delaware\"))\n\n  state_name       county_name total_votes_20 repub_pct_20 dem_pct_20\n1   Delaware       Kent County          87025        47.12      51.19\n2   Delaware New Castle County         287633        30.72      67.81\n3   Delaware     Sussex County         129352        55.07      43.82\n4     Hawaii     Hawaii County          87814        30.63      66.88\n5     Hawaii   Honolulu County         382114        35.66      62.51\n6     Hawaii      Kauai County          33497        34.58      63.36\n7     Hawaii       Maui County          71044        31.14      66.59\n  total_votes_16 dem_pct_16\n1          74253      44.91\n2         261468      62.30\n3         105814      37.17\n4          64865      63.61\n5         285683      61.48\n6          26335      62.49\n7          51942      64.45\n\n\n\n# Keep only data on counties where the Republican got MORE THAN 93.97% of the vote in 2020\n# THINK: What variable is relevant here?\n# Total votes are very small.\nelections_small |&gt;\n  filter(repub_pct_20 &gt; 93.97)\n\n  state_name    county_name total_votes_20 repub_pct_20 dem_pct_20\n1      Texas  Borden County            416        95.43       3.85\n2      Texas    King County            159        94.97       5.03\n3      Texas Roberts County            550        96.18       3.09\n  total_votes_16 dem_pct_16\n1            365       8.49\n2            159       3.14\n3            550       3.64\n\n\n\n# Keep only data on counties where the Republican got AT LEAST 93.97% of the vote in 2020\n# This should have 1 more row (observation) than your answer above\nelections_small |&gt;\n  filter(repub_pct_20 &gt;= 93.97)\n\n  state_name     county_name total_votes_20 repub_pct_20 dem_pct_20\n1    Montana Garfield County            813        93.97       5.04\n2      Texas   Borden County            416        95.43       3.85\n3      Texas     King County            159        94.97       5.03\n4      Texas  Roberts County            550        96.18       3.09\n  total_votes_16 dem_pct_16\n1            715       4.76\n2            365       8.49\n3            159       3.14\n4            550       3.64\n\n\nWe can also filter with respect to 2 rules! Here, think what variables are relevant.\n\n# Keep only data on counties in Texas where the Democrat got more than 65% of the vote in 2020\n# Do this 2 ways.\n# Method 1: 2 filters with 1 condition each\nelections_small |&gt;\n filter(state_name == \"Texas\") |&gt;\n filter(repub_pct_20 &gt; 65)\n\n    state_name          county_name total_votes_20 repub_pct_20 dem_pct_20\n1        Texas      Anderson County          19227        78.59      20.57\n2        Texas       Andrews County           5863        84.31      14.50\n3        Texas      Angelina County          34574        72.53      26.44\n4        Texas       Aransas County          12290        75.17      23.73\n5        Texas        Archer County           4796        89.66       9.30\n6        Texas     Armstrong County           1112        93.08       6.74\n7        Texas      Atascosa County          18118        66.45      32.43\n8        Texas        Austin County          14554        78.65      20.28\n9        Texas        Bailey County           1860        77.10      21.99\n10       Texas       Bandera County          12715        79.10      19.70\n11       Texas        Baylor County           1702        87.78      10.75\n12       Texas        Blanco County           7441        73.15      25.68\n13       Texas        Borden County            416        95.43       3.85\n14       Texas        Bosque County           9126        81.84      17.10\n15       Texas         Bowie County          38261        70.87      28.09\n16       Texas       Briscoe County            725        88.14      10.76\n17       Texas         Brown County          15969        85.78      13.19\n18       Texas      Burleson County           8609        78.33      20.77\n19       Texas        Burnet County          24717        75.93      22.81\n20       Texas       Calhoun County           7856        71.80      27.34\n21       Texas      Callahan County           6832        88.00      10.74\n22       Texas          Camp County           5060        71.66      27.55\n23       Texas        Carson County           3122        89.01       9.51\n24       Texas          Cass County          13927        79.22      20.07\n25       Texas        Castro County           2083        76.91      22.37\n26       Texas      Chambers County          21652        80.15      18.46\n27       Texas      Cherokee County          19508        77.41      21.58\n28       Texas     Childress County           2279        85.26      13.60\n29       Texas          Clay County           5741        88.29      10.70\n30       Texas       Cochran County           1000        80.90      17.70\n31       Texas          Coke County           1779        89.15      10.01\n32       Texas       Coleman County           4124        88.29      10.94\n33       Texas Collingsworth County           1218        86.04      12.73\n34       Texas      Colorado County           9975        74.91      24.26\n35       Texas         Comal County          88863        70.60      27.94\n36       Texas      Comanche County           6086        85.06      14.02\n37       Texas        Concho County           1268        83.44      15.54\n38       Texas         Cooke County          18988        82.14      16.91\n39       Texas       Coryell County          23490        65.72      32.21\n40       Texas        Cottle County            662        81.57      17.07\n41       Texas         Crane County           1503        82.97      16.03\n42       Texas      Crockett County           1574        77.51      21.86\n43       Texas        Crosby County           1953        71.48      26.98\n44       Texas        Dallam County           1609        86.33      12.24\n45       Texas        Dawson County           3789        77.88      21.32\n46       Texas    Deaf Smith County           4610        71.45      27.42\n47       Texas         Delta County           2592        83.41      15.55\n48       Texas        DeWitt County           8118        80.89      18.40\n49       Texas       Dickens County            988        86.34      13.16\n50       Texas        Donley County           1648        87.26      12.01\n51       Texas      Eastland County           8292        87.28      11.85\n52       Texas         Ector County          44581        73.34      25.50\n53       Texas       Edwards County           1066        83.77      15.76\n54       Texas         Ellis County          85493        66.34      32.24\n55       Texas         Erath County          16853        81.20      17.30\n56       Texas         Falls County           6133        68.11      30.96\n57       Texas        Fannin County          15004        81.12      17.70\n58       Texas       Fayette County          12941        78.60      20.56\n59       Texas        Fisher County           1826        79.30      19.28\n60       Texas         Floyd County           2039        77.69      21.48\n61       Texas         Foard County            551        80.76      17.97\n62       Texas      Franklin County           5009        83.07      16.05\n63       Texas     Freestone County           8711        80.25      18.77\n64       Texas        Gaines County           5995        89.32       9.61\n65       Texas         Garza County           1653        85.48      13.97\n66       Texas     Gillespie County          15846        78.97      20.04\n67       Texas     Glasscock County            653        93.57       5.97\n68       Texas        Goliad County           3988        77.36      21.99\n69       Texas      Gonzales County           7647        73.58      25.47\n70       Texas          Gray County           7782        87.90      10.65\n71       Texas       Grayson County          59439        74.30      24.40\n72       Texas         Gregg County          47982        67.72      30.84\n73       Texas        Grimes County          12413        75.98      22.82\n74       Texas          Hale County           9584        74.89      23.78\n75       Texas          Hall County           1168        85.19      14.38\n76       Texas      Hamilton County           4349        83.15      14.74\n77       Texas      Hansford County           2047        90.33       8.11\n78       Texas      Hardeman County           1580        84.18      15.25\n79       Texas        Hardin County          27635        86.33      12.57\n80       Texas      Harrison County          29710        72.25      26.62\n81       Texas       Hartley County           2078        89.89       9.38\n82       Texas       Haskell County           2214        83.11      15.94\n83       Texas      Hemphill County           1720        86.40      11.98\n84       Texas     Henderson County          36310        79.62      19.44\n85       Texas          Hill County          14931        79.87      19.15\n86       Texas       Hockley County           8095        80.74      18.31\n87       Texas          Hood County          32541        81.42      17.36\n88       Texas       Hopkins County          15939        79.80      19.11\n89       Texas       Houston County           9437        74.81      24.52\n90       Texas        Howard County          10240        78.65      20.21\n91       Texas      Hudspeth County           1165        66.87      31.85\n92       Texas          Hunt County          38574        75.60      23.09\n93       Texas    Hutchinson County           8771        87.57      11.00\n94       Texas         Irion County            889        85.38      13.50\n95       Texas          Jack County           3782        90.38       8.75\n96       Texas       Jackson County           6340        82.51      16.29\n97       Texas        Jasper County          15608        80.36      18.93\n98       Texas       Johnson County          72005        75.87      22.87\n99       Texas         Jones County           6741        83.96      14.82\n100      Texas        Karnes County           5249        75.60      23.51\n101      Texas       Kaufman County          56703        66.35      32.46\n102      Texas       Kendall County          26438        75.96      22.77\n103      Texas        Kenedy County            194        65.46      33.51\n104      Texas          Kent County            462        88.96      10.17\n105      Texas          Kerr County          27745        75.25      23.51\n106      Texas        Kimble County           2292        86.69      12.39\n107      Texas          King County            159        94.97       5.03\n108      Texas        Kinney County           1603        71.37      27.82\n109      Texas          Knox County           1456        81.04      18.20\n110      Texas         Lamar County          21418        78.25      20.81\n111      Texas          Lamb County           4408        79.88      19.06\n112      Texas      Lampasas County          10399        77.76      20.62\n113      Texas        Lavaca County          10197        86.34      13.07\n114      Texas           Lee County           8086        77.36      21.64\n115      Texas          Leon County           8674        86.73      12.36\n116      Texas       Liberty County          29334        79.44      19.72\n117      Texas     Limestone County           9095        74.65      24.33\n118      Texas      Lipscomb County           1353        89.06       9.68\n119      Texas      Live Oak County           5054        83.08      16.20\n120      Texas         Llano County          12660        79.61      19.47\n121      Texas        Loving County             66        90.91       6.06\n122      Texas       Lubbock County         120771        65.30      33.13\n123      Texas          Lynn County           2293        80.81      18.67\n124      Texas     McCulloch County           3436        84.52      14.26\n125      Texas      McMullen County            516        89.15      10.27\n126      Texas       Madison County           5297        78.70      20.54\n127      Texas        Marion County           4864        71.34      27.53\n128      Texas        Martin County           2160        85.97      13.33\n129      Texas         Mason County           2474        80.48      18.47\n130      Texas     Matagorda County          13726        71.73      27.20\n131      Texas        Medina County          22644        69.08      29.91\n132      Texas        Menard County           1028        80.06      19.16\n133      Texas       Midland County          58856        77.52      20.95\n134      Texas         Milam County          10576        75.49      23.60\n135      Texas         Mills County           2505        88.50      10.82\n136      Texas      Mitchell County           2579        84.14      15.39\n137      Texas      Montague County           9814        87.78      11.18\n138      Texas    Montgomery County         271451        71.24      27.40\n139      Texas         Moore County           5508        79.14      19.28\n140      Texas        Morris County           5587        69.30      29.87\n141      Texas        Motley County            652        92.64       7.06\n142      Texas       Navarro County          19121        72.17      26.68\n143      Texas        Newton County           6094        80.11      19.25\n144      Texas         Nolan County           5356        77.13      21.70\n145      Texas     Ochiltree County           3156        89.10       9.57\n146      Texas        Oldham County           1009        90.88       8.03\n147      Texas        Orange County          35994        81.09      17.66\n148      Texas    Palo Pinto County          12485        81.53      17.44\n149      Texas        Panola County          11451        81.44      17.96\n150      Texas        Parker County          76128        81.50      17.10\n151      Texas        Parmer County           2650        80.57      18.42\n152      Texas         Pecos County           4668        68.87      29.61\n153      Texas          Polk County          24181        76.81      22.28\n154      Texas        Potter County          33321        68.49      29.77\n155      Texas         Rains County           6053        85.16      13.91\n156      Texas       Randall County          64674        78.54      19.79\n157      Texas        Reagan County           1124        83.81      15.30\n158      Texas          Real County           1982        82.90      16.15\n159      Texas     Red River County           5806        77.80      21.46\n160      Texas       Refugio County           3366        65.66      32.92\n161      Texas       Roberts County            550        96.18       3.09\n162      Texas     Robertson County           8099        69.71      29.31\n163      Texas      Rockwall County          53891        68.15      30.45\n164      Texas       Runnels County           4409        86.35      12.52\n165      Texas          Rusk County          21368        77.38      21.66\n166      Texas        Sabine County           5487        87.19      12.19\n167      Texas San Augustine County           4002        75.14      24.49\n168      Texas   San Jacinto County          12638        80.40      18.49\n169      Texas      San Saba County           2602        88.70      11.03\n170      Texas    Schleicher County           1159        81.10      18.21\n171      Texas        Scurry County           5869        84.90      13.94\n172      Texas   Shackelford County           1628        91.15       7.99\n173      Texas        Shelby County          10084        79.09      20.51\n174      Texas       Sherman County            991        89.40       9.18\n175      Texas         Smith County         100075        69.03      29.59\n176      Texas     Somervell County           4947        82.98      15.52\n177      Texas      Stephens County           3800        89.08      10.45\n178      Texas      Sterling County            639        91.39       7.98\n179      Texas     Stonewall County            736        83.56      15.76\n180      Texas        Sutton County           1557        78.48      20.68\n181      Texas       Swisher County           2355        78.34      20.30\n182      Texas        Taylor County          55112        71.76      26.47\n183      Texas       Terrell County            458        72.93      25.98\n184      Texas         Terry County           3612        77.85      20.96\n185      Texas  Throckmorton County            899        89.66       9.12\n186      Texas         Titus County          10539        71.83      27.10\n187      Texas     Tom Green County          45210        71.47      27.07\n188      Texas       Trinity County           6938        80.41      19.07\n189      Texas         Tyler County           9660        84.82      14.52\n190      Texas        Upshur County          18887        83.70      15.23\n191      Texas         Upton County           1368        86.11      12.43\n192      Texas     Van Zandt County          25994        85.67      13.53\n193      Texas      Victoria County          34188        68.32      30.36\n194      Texas        Walker County          23612        65.12      33.39\n195      Texas          Ward County           4060        79.83      18.82\n196      Texas    Washington County          17418        74.40      24.46\n197      Texas       Wharton County          16761        71.15      28.01\n198      Texas       Wheeler County           2337        92.38       7.19\n199      Texas       Wichita County          46030        69.67      28.59\n200      Texas     Wilbarger County           4524        77.90      21.13\n201      Texas        Wilson County          25013        73.81      25.39\n202      Texas       Winkler County           2126        82.46      16.84\n203      Texas          Wise County          32362        83.53      15.37\n204      Texas          Wood County          22779        83.63      15.40\n205      Texas        Yoakum County           2631        82.63      15.96\n206      Texas         Young County           8239        86.30      12.55\n    total_votes_16 dem_pct_16\n1            16887      19.89\n2             4926      16.97\n3            29870      25.24\n4            10467      23.48\n5             4269       9.23\n6             1017       6.88\n7            13605      34.07\n8            12255      18.92\n9             1784      22.25\n10           10213      16.90\n11            1492      12.80\n12            5669      21.94\n13             365       8.49\n14            7797      16.38\n15           34470      25.62\n16             734      12.40\n17           13949      11.62\n18            6945      21.47\n19           19046      19.87\n20            6957      30.44\n21            5556      10.22\n22            4542      27.74\n23            2945       8.46\n24           11606      19.39\n25            1996      26.35\n26           16661      17.64\n27           16701      20.75\n28            2084      12.14\n29            5011      10.70\n30             901      21.09\n31            1423       9.84\n32            3635      10.65\n33            1154      12.56\n34            8480      23.31\n35           61567      23.01\n36            5208      15.13\n37            1067      13.87\n38           15894      14.75\n39           18127      27.90\n40             583      14.41\n41            1381      21.65\n42            1395      26.67\n43            1712      27.34\n44            1535      14.46\n45            3562      23.44\n46            4201      28.21\n47            2279      17.55\n48            6822      17.02\n49             909      14.08\n50            1460      13.01\n51            6935      11.19\n52           36373      28.11\n53            1065      28.36\n54           63064      25.68\n55           13810      15.63\n56            5232      32.15\n57           11972      17.73\n58           11029      19.29\n59            1722      23.40\n60            1958      22.22\n61             511      22.11\n62            4356      15.27\n63            7608      19.20\n64            4609      12.95\n65            1475      15.19\n66           13123      17.42\n67             602       5.65\n68            3713      26.21\n69            6304      24.86\n70            7360       9.50\n71           47068      21.83\n72           41365      28.10\n73            9528      23.03\n74            8802      23.74\n75            1089      15.06\n76            3609      13.27\n77            1947       8.78\n78            1511      16.48\n79           22768      12.21\n80           26364      27.04\n81            1945       8.84\n82            1765      17.79\n83            1687      10.73\n84           29855      18.92\n85           12906      19.64\n86            7282      17.26\n87           26120      15.32\n88           13476      18.61\n89            8302      23.83\n90            8692      20.34\n91             871      37.20\n92           31185      20.21\n93            8126      10.51\n94             760      11.84\n95            3339       9.40\n96            5275      17.14\n97           13351      19.34\n98           57270      19.17\n99            5932      15.76\n100           4185      27.34\n101          40979      25.05\n102          19936      18.22\n103            186      53.23\n104            433      13.63\n105          23090      20.20\n106           1945      10.59\n107            159       3.14\n108           1424      32.09\n109           1358      18.19\n110          18537      19.31\n111           3905      19.72\n112           8149      18.15\n113           8633      13.55\n114           6522      21.04\n115           7407      12.27\n116          24155      20.08\n117           7648      22.86\n118           1322      10.21\n119           4267      17.32\n120          10377      17.59\n121             64       6.25\n122          98060      28.51\n123           1997      20.18\n124           3086      15.55\n125            497       8.05\n126           4283      20.57\n127           4206      27.48\n128           1755      15.16\n129           2053      17.19\n130          11779      28.50\n131          17187      26.90\n132            860      17.79\n133          48753      20.50\n134           8607      23.72\n135           2238      10.81\n136           2190      16.12\n137           8604      10.29\n138         203083      22.52\n139           5262      20.83\n140           4964      28.71\n141            620       6.45\n142          16382      24.40\n143           4010      24.39\n144           4744      21.69\n145           2981       9.19\n146            945       8.25\n147          31761      18.00\n148          10175      16.71\n149          10413      17.62\n150          56413      14.76\n151           2818      30.09\n152           4167      37.22\n153          34444      20.68\n154          28330      26.90\n155           4630      13.37\n156          53813      15.50\n157            900      18.56\n158           1678      15.61\n159           5147      22.30\n160           2945      35.11\n161            550       3.64\n162           7010      31.43\n163          39529      24.37\n164           3765      12.01\n165          18994      20.72\n166           4642      13.23\n167           3563      25.46\n168          10305      19.74\n169           2354      12.45\n170           1054      19.83\n171           5261      13.93\n172           1502       6.86\n173           9072      19.37\n174            933      10.29\n175          83161      26.61\n176           3876      13.93\n177           3453      10.08\n178            633      11.06\n179            701      19.26\n180           1415      22.12\n181           2190      21.10\n182          45266      22.20\n183            437      32.04\n184           1763      24.05\n185            808      10.40\n186           9176      27.66\n187          38104      23.93\n188           5982      19.29\n189           7969      15.60\n190          15918      14.94\n191           1296      21.91\n192          21689      12.87\n193          31032      28.50\n194          19683      30.92\n195           3413      22.85\n196          14747      22.93\n197          14707      28.82\n198           2306       8.41\n199          37913      23.08\n200           4101      19.68\n201          19255      24.88\n202           1873      22.42\n203          24661      13.84\n204          18646      14.07\n205           2299      18.53\n206           7658      11.40\n\n# Method 2: 1 filter with 2 conditions\nelections_small |&gt; \nfilter(state_name == \"Texas\", repub_pct_20 &gt; 65)\n\n    state_name          county_name total_votes_20 repub_pct_20 dem_pct_20\n1        Texas      Anderson County          19227        78.59      20.57\n2        Texas       Andrews County           5863        84.31      14.50\n3        Texas      Angelina County          34574        72.53      26.44\n4        Texas       Aransas County          12290        75.17      23.73\n5        Texas        Archer County           4796        89.66       9.30\n6        Texas     Armstrong County           1112        93.08       6.74\n7        Texas      Atascosa County          18118        66.45      32.43\n8        Texas        Austin County          14554        78.65      20.28\n9        Texas        Bailey County           1860        77.10      21.99\n10       Texas       Bandera County          12715        79.10      19.70\n11       Texas        Baylor County           1702        87.78      10.75\n12       Texas        Blanco County           7441        73.15      25.68\n13       Texas        Borden County            416        95.43       3.85\n14       Texas        Bosque County           9126        81.84      17.10\n15       Texas         Bowie County          38261        70.87      28.09\n16       Texas       Briscoe County            725        88.14      10.76\n17       Texas         Brown County          15969        85.78      13.19\n18       Texas      Burleson County           8609        78.33      20.77\n19       Texas        Burnet County          24717        75.93      22.81\n20       Texas       Calhoun County           7856        71.80      27.34\n21       Texas      Callahan County           6832        88.00      10.74\n22       Texas          Camp County           5060        71.66      27.55\n23       Texas        Carson County           3122        89.01       9.51\n24       Texas          Cass County          13927        79.22      20.07\n25       Texas        Castro County           2083        76.91      22.37\n26       Texas      Chambers County          21652        80.15      18.46\n27       Texas      Cherokee County          19508        77.41      21.58\n28       Texas     Childress County           2279        85.26      13.60\n29       Texas          Clay County           5741        88.29      10.70\n30       Texas       Cochran County           1000        80.90      17.70\n31       Texas          Coke County           1779        89.15      10.01\n32       Texas       Coleman County           4124        88.29      10.94\n33       Texas Collingsworth County           1218        86.04      12.73\n34       Texas      Colorado County           9975        74.91      24.26\n35       Texas         Comal County          88863        70.60      27.94\n36       Texas      Comanche County           6086        85.06      14.02\n37       Texas        Concho County           1268        83.44      15.54\n38       Texas         Cooke County          18988        82.14      16.91\n39       Texas       Coryell County          23490        65.72      32.21\n40       Texas        Cottle County            662        81.57      17.07\n41       Texas         Crane County           1503        82.97      16.03\n42       Texas      Crockett County           1574        77.51      21.86\n43       Texas        Crosby County           1953        71.48      26.98\n44       Texas        Dallam County           1609        86.33      12.24\n45       Texas        Dawson County           3789        77.88      21.32\n46       Texas    Deaf Smith County           4610        71.45      27.42\n47       Texas         Delta County           2592        83.41      15.55\n48       Texas        DeWitt County           8118        80.89      18.40\n49       Texas       Dickens County            988        86.34      13.16\n50       Texas        Donley County           1648        87.26      12.01\n51       Texas      Eastland County           8292        87.28      11.85\n52       Texas         Ector County          44581        73.34      25.50\n53       Texas       Edwards County           1066        83.77      15.76\n54       Texas         Ellis County          85493        66.34      32.24\n55       Texas         Erath County          16853        81.20      17.30\n56       Texas         Falls County           6133        68.11      30.96\n57       Texas        Fannin County          15004        81.12      17.70\n58       Texas       Fayette County          12941        78.60      20.56\n59       Texas        Fisher County           1826        79.30      19.28\n60       Texas         Floyd County           2039        77.69      21.48\n61       Texas         Foard County            551        80.76      17.97\n62       Texas      Franklin County           5009        83.07      16.05\n63       Texas     Freestone County           8711        80.25      18.77\n64       Texas        Gaines County           5995        89.32       9.61\n65       Texas         Garza County           1653        85.48      13.97\n66       Texas     Gillespie County          15846        78.97      20.04\n67       Texas     Glasscock County            653        93.57       5.97\n68       Texas        Goliad County           3988        77.36      21.99\n69       Texas      Gonzales County           7647        73.58      25.47\n70       Texas          Gray County           7782        87.90      10.65\n71       Texas       Grayson County          59439        74.30      24.40\n72       Texas         Gregg County          47982        67.72      30.84\n73       Texas        Grimes County          12413        75.98      22.82\n74       Texas          Hale County           9584        74.89      23.78\n75       Texas          Hall County           1168        85.19      14.38\n76       Texas      Hamilton County           4349        83.15      14.74\n77       Texas      Hansford County           2047        90.33       8.11\n78       Texas      Hardeman County           1580        84.18      15.25\n79       Texas        Hardin County          27635        86.33      12.57\n80       Texas      Harrison County          29710        72.25      26.62\n81       Texas       Hartley County           2078        89.89       9.38\n82       Texas       Haskell County           2214        83.11      15.94\n83       Texas      Hemphill County           1720        86.40      11.98\n84       Texas     Henderson County          36310        79.62      19.44\n85       Texas          Hill County          14931        79.87      19.15\n86       Texas       Hockley County           8095        80.74      18.31\n87       Texas          Hood County          32541        81.42      17.36\n88       Texas       Hopkins County          15939        79.80      19.11\n89       Texas       Houston County           9437        74.81      24.52\n90       Texas        Howard County          10240        78.65      20.21\n91       Texas      Hudspeth County           1165        66.87      31.85\n92       Texas          Hunt County          38574        75.60      23.09\n93       Texas    Hutchinson County           8771        87.57      11.00\n94       Texas         Irion County            889        85.38      13.50\n95       Texas          Jack County           3782        90.38       8.75\n96       Texas       Jackson County           6340        82.51      16.29\n97       Texas        Jasper County          15608        80.36      18.93\n98       Texas       Johnson County          72005        75.87      22.87\n99       Texas         Jones County           6741        83.96      14.82\n100      Texas        Karnes County           5249        75.60      23.51\n101      Texas       Kaufman County          56703        66.35      32.46\n102      Texas       Kendall County          26438        75.96      22.77\n103      Texas        Kenedy County            194        65.46      33.51\n104      Texas          Kent County            462        88.96      10.17\n105      Texas          Kerr County          27745        75.25      23.51\n106      Texas        Kimble County           2292        86.69      12.39\n107      Texas          King County            159        94.97       5.03\n108      Texas        Kinney County           1603        71.37      27.82\n109      Texas          Knox County           1456        81.04      18.20\n110      Texas         Lamar County          21418        78.25      20.81\n111      Texas          Lamb County           4408        79.88      19.06\n112      Texas      Lampasas County          10399        77.76      20.62\n113      Texas        Lavaca County          10197        86.34      13.07\n114      Texas           Lee County           8086        77.36      21.64\n115      Texas          Leon County           8674        86.73      12.36\n116      Texas       Liberty County          29334        79.44      19.72\n117      Texas     Limestone County           9095        74.65      24.33\n118      Texas      Lipscomb County           1353        89.06       9.68\n119      Texas      Live Oak County           5054        83.08      16.20\n120      Texas         Llano County          12660        79.61      19.47\n121      Texas        Loving County             66        90.91       6.06\n122      Texas       Lubbock County         120771        65.30      33.13\n123      Texas          Lynn County           2293        80.81      18.67\n124      Texas     McCulloch County           3436        84.52      14.26\n125      Texas      McMullen County            516        89.15      10.27\n126      Texas       Madison County           5297        78.70      20.54\n127      Texas        Marion County           4864        71.34      27.53\n128      Texas        Martin County           2160        85.97      13.33\n129      Texas         Mason County           2474        80.48      18.47\n130      Texas     Matagorda County          13726        71.73      27.20\n131      Texas        Medina County          22644        69.08      29.91\n132      Texas        Menard County           1028        80.06      19.16\n133      Texas       Midland County          58856        77.52      20.95\n134      Texas         Milam County          10576        75.49      23.60\n135      Texas         Mills County           2505        88.50      10.82\n136      Texas      Mitchell County           2579        84.14      15.39\n137      Texas      Montague County           9814        87.78      11.18\n138      Texas    Montgomery County         271451        71.24      27.40\n139      Texas         Moore County           5508        79.14      19.28\n140      Texas        Morris County           5587        69.30      29.87\n141      Texas        Motley County            652        92.64       7.06\n142      Texas       Navarro County          19121        72.17      26.68\n143      Texas        Newton County           6094        80.11      19.25\n144      Texas         Nolan County           5356        77.13      21.70\n145      Texas     Ochiltree County           3156        89.10       9.57\n146      Texas        Oldham County           1009        90.88       8.03\n147      Texas        Orange County          35994        81.09      17.66\n148      Texas    Palo Pinto County          12485        81.53      17.44\n149      Texas        Panola County          11451        81.44      17.96\n150      Texas        Parker County          76128        81.50      17.10\n151      Texas        Parmer County           2650        80.57      18.42\n152      Texas         Pecos County           4668        68.87      29.61\n153      Texas          Polk County          24181        76.81      22.28\n154      Texas        Potter County          33321        68.49      29.77\n155      Texas         Rains County           6053        85.16      13.91\n156      Texas       Randall County          64674        78.54      19.79\n157      Texas        Reagan County           1124        83.81      15.30\n158      Texas          Real County           1982        82.90      16.15\n159      Texas     Red River County           5806        77.80      21.46\n160      Texas       Refugio County           3366        65.66      32.92\n161      Texas       Roberts County            550        96.18       3.09\n162      Texas     Robertson County           8099        69.71      29.31\n163      Texas      Rockwall County          53891        68.15      30.45\n164      Texas       Runnels County           4409        86.35      12.52\n165      Texas          Rusk County          21368        77.38      21.66\n166      Texas        Sabine County           5487        87.19      12.19\n167      Texas San Augustine County           4002        75.14      24.49\n168      Texas   San Jacinto County          12638        80.40      18.49\n169      Texas      San Saba County           2602        88.70      11.03\n170      Texas    Schleicher County           1159        81.10      18.21\n171      Texas        Scurry County           5869        84.90      13.94\n172      Texas   Shackelford County           1628        91.15       7.99\n173      Texas        Shelby County          10084        79.09      20.51\n174      Texas       Sherman County            991        89.40       9.18\n175      Texas         Smith County         100075        69.03      29.59\n176      Texas     Somervell County           4947        82.98      15.52\n177      Texas      Stephens County           3800        89.08      10.45\n178      Texas      Sterling County            639        91.39       7.98\n179      Texas     Stonewall County            736        83.56      15.76\n180      Texas        Sutton County           1557        78.48      20.68\n181      Texas       Swisher County           2355        78.34      20.30\n182      Texas        Taylor County          55112        71.76      26.47\n183      Texas       Terrell County            458        72.93      25.98\n184      Texas         Terry County           3612        77.85      20.96\n185      Texas  Throckmorton County            899        89.66       9.12\n186      Texas         Titus County          10539        71.83      27.10\n187      Texas     Tom Green County          45210        71.47      27.07\n188      Texas       Trinity County           6938        80.41      19.07\n189      Texas         Tyler County           9660        84.82      14.52\n190      Texas        Upshur County          18887        83.70      15.23\n191      Texas         Upton County           1368        86.11      12.43\n192      Texas     Van Zandt County          25994        85.67      13.53\n193      Texas      Victoria County          34188        68.32      30.36\n194      Texas        Walker County          23612        65.12      33.39\n195      Texas          Ward County           4060        79.83      18.82\n196      Texas    Washington County          17418        74.40      24.46\n197      Texas       Wharton County          16761        71.15      28.01\n198      Texas       Wheeler County           2337        92.38       7.19\n199      Texas       Wichita County          46030        69.67      28.59\n200      Texas     Wilbarger County           4524        77.90      21.13\n201      Texas        Wilson County          25013        73.81      25.39\n202      Texas       Winkler County           2126        82.46      16.84\n203      Texas          Wise County          32362        83.53      15.37\n204      Texas          Wood County          22779        83.63      15.40\n205      Texas        Yoakum County           2631        82.63      15.96\n206      Texas         Young County           8239        86.30      12.55\n    total_votes_16 dem_pct_16\n1            16887      19.89\n2             4926      16.97\n3            29870      25.24\n4            10467      23.48\n5             4269       9.23\n6             1017       6.88\n7            13605      34.07\n8            12255      18.92\n9             1784      22.25\n10           10213      16.90\n11            1492      12.80\n12            5669      21.94\n13             365       8.49\n14            7797      16.38\n15           34470      25.62\n16             734      12.40\n17           13949      11.62\n18            6945      21.47\n19           19046      19.87\n20            6957      30.44\n21            5556      10.22\n22            4542      27.74\n23            2945       8.46\n24           11606      19.39\n25            1996      26.35\n26           16661      17.64\n27           16701      20.75\n28            2084      12.14\n29            5011      10.70\n30             901      21.09\n31            1423       9.84\n32            3635      10.65\n33            1154      12.56\n34            8480      23.31\n35           61567      23.01\n36            5208      15.13\n37            1067      13.87\n38           15894      14.75\n39           18127      27.90\n40             583      14.41\n41            1381      21.65\n42            1395      26.67\n43            1712      27.34\n44            1535      14.46\n45            3562      23.44\n46            4201      28.21\n47            2279      17.55\n48            6822      17.02\n49             909      14.08\n50            1460      13.01\n51            6935      11.19\n52           36373      28.11\n53            1065      28.36\n54           63064      25.68\n55           13810      15.63\n56            5232      32.15\n57           11972      17.73\n58           11029      19.29\n59            1722      23.40\n60            1958      22.22\n61             511      22.11\n62            4356      15.27\n63            7608      19.20\n64            4609      12.95\n65            1475      15.19\n66           13123      17.42\n67             602       5.65\n68            3713      26.21\n69            6304      24.86\n70            7360       9.50\n71           47068      21.83\n72           41365      28.10\n73            9528      23.03\n74            8802      23.74\n75            1089      15.06\n76            3609      13.27\n77            1947       8.78\n78            1511      16.48\n79           22768      12.21\n80           26364      27.04\n81            1945       8.84\n82            1765      17.79\n83            1687      10.73\n84           29855      18.92\n85           12906      19.64\n86            7282      17.26\n87           26120      15.32\n88           13476      18.61\n89            8302      23.83\n90            8692      20.34\n91             871      37.20\n92           31185      20.21\n93            8126      10.51\n94             760      11.84\n95            3339       9.40\n96            5275      17.14\n97           13351      19.34\n98           57270      19.17\n99            5932      15.76\n100           4185      27.34\n101          40979      25.05\n102          19936      18.22\n103            186      53.23\n104            433      13.63\n105          23090      20.20\n106           1945      10.59\n107            159       3.14\n108           1424      32.09\n109           1358      18.19\n110          18537      19.31\n111           3905      19.72\n112           8149      18.15\n113           8633      13.55\n114           6522      21.04\n115           7407      12.27\n116          24155      20.08\n117           7648      22.86\n118           1322      10.21\n119           4267      17.32\n120          10377      17.59\n121             64       6.25\n122          98060      28.51\n123           1997      20.18\n124           3086      15.55\n125            497       8.05\n126           4283      20.57\n127           4206      27.48\n128           1755      15.16\n129           2053      17.19\n130          11779      28.50\n131          17187      26.90\n132            860      17.79\n133          48753      20.50\n134           8607      23.72\n135           2238      10.81\n136           2190      16.12\n137           8604      10.29\n138         203083      22.52\n139           5262      20.83\n140           4964      28.71\n141            620       6.45\n142          16382      24.40\n143           4010      24.39\n144           4744      21.69\n145           2981       9.19\n146            945       8.25\n147          31761      18.00\n148          10175      16.71\n149          10413      17.62\n150          56413      14.76\n151           2818      30.09\n152           4167      37.22\n153          34444      20.68\n154          28330      26.90\n155           4630      13.37\n156          53813      15.50\n157            900      18.56\n158           1678      15.61\n159           5147      22.30\n160           2945      35.11\n161            550       3.64\n162           7010      31.43\n163          39529      24.37\n164           3765      12.01\n165          18994      20.72\n166           4642      13.23\n167           3563      25.46\n168          10305      19.74\n169           2354      12.45\n170           1054      19.83\n171           5261      13.93\n172           1502       6.86\n173           9072      19.37\n174            933      10.29\n175          83161      26.61\n176           3876      13.93\n177           3453      10.08\n178            633      11.06\n179            701      19.26\n180           1415      22.12\n181           2190      21.10\n182          45266      22.20\n183            437      32.04\n184           1763      24.05\n185            808      10.40\n186           9176      27.66\n187          38104      23.93\n188           5982      19.29\n189           7969      15.60\n190          15918      14.94\n191           1296      21.91\n192          21689      12.87\n193          31032      28.50\n194          19683      30.92\n195           3413      22.85\n196          14747      22.93\n197          14707      28.82\n198           2306       8.41\n199          37913      23.08\n200           4101      19.68\n201          19255      24.88\n202           1873      22.42\n203          24661      13.84\n204          18646      14.07\n205           2299      18.53\n206           7658      11.40\n\n\nExercise 3: arrange Demo\narrange() arranges or sorts the rows in a dataset according to a given column or variable, in ascending or descending order:\narrange(variable), arrange(desc(variable))\n\n# Arrange the counties in elections_small from lowest to highest percentage of 2020 Republican support\n# Print out just the first 6 rows\nelections_small |&gt;\n  arrange(repub_pct_20) |&gt;\n  head(6)\n\n            state_name            county_name total_votes_20 repub_pct_20\n1 District of Columbia   District of Columbia         344356         5.40\n2             Maryland Prince George's County         424855         8.73\n3             Maryland         Baltimore city         237461        10.69\n4             Virginia        Petersburg city          14118        11.22\n5             New York        New York County         694904        12.26\n6           California   San Francisco County         443458        12.72\n  dem_pct_20 total_votes_16 dem_pct_16\n1      92.15         280272      92.85\n2      89.26         351091      89.33\n3      87.28         208980      85.44\n4      87.75          13717      87.52\n5      86.78         591368      87.17\n6      85.27         365295      85.53\n\n\n\n# Arrange the counties in elections_small from highest to lowest percentage of 2020 Republican support\n# Print out just the first 6 rows\nelections_small |&gt;\n  arrange(desc(repub_pct_20)) |&gt;\n  head(6)\n\n  state_name      county_name total_votes_20 repub_pct_20 dem_pct_20\n1      Texas   Roberts County            550        96.18       3.09\n2      Texas    Borden County            416        95.43       3.85\n3      Texas      King County            159        94.97       5.03\n4    Montana  Garfield County            813        93.97       5.04\n5      Texas Glasscock County            653        93.57       5.97\n6   Nebraska     Grant County            402        93.28       4.98\n  total_votes_16 dem_pct_16\n1            550       3.64\n2            365       8.49\n3            159       3.14\n4            715       4.76\n5            602       5.65\n6            394       5.08\n\n\nExercise 4: mutate Demo\nmutate() can either transform / mutate an existing variable (column), or define a new variable based on existing ones.\nPart a\n\n# What did this code do?\n# Adds a new column of difference between repub/dem 20\nelections_small |&gt;\n  mutate(diff_20 = repub_pct_20 - dem_pct_20) |&gt;\n  head()\n\n  state_name    county_name total_votes_20 repub_pct_20 dem_pct_20\n1    Alabama Autauga County          27770        71.44      27.02\n2    Alabama Baldwin County         109679        76.17      22.41\n3    Alabama Barbour County          10518        53.45      45.79\n4    Alabama    Bibb County           9595        78.43      20.70\n5    Alabama  Blount County          27588        89.57       9.57\n6    Alabama Bullock County           4613        24.84      74.70\n  total_votes_16 dem_pct_16 diff_20\n1          24661      23.96   44.42\n2          94090      19.57   53.76\n3          10390      46.66    7.66\n4           8748      21.42   57.73\n5          25384       8.47   80.00\n6           4701      75.09  -49.86\n\n\n\n# What did this code do?\n# Calculate the number of repub _votes and add a column of this\nelections_small |&gt;\n  mutate(repub_votes_20 = round(total_votes_20 * repub_pct_20/100)) |&gt;\n  head()\n\n  state_name    county_name total_votes_20 repub_pct_20 dem_pct_20\n1    Alabama Autauga County          27770        71.44      27.02\n2    Alabama Baldwin County         109679        76.17      22.41\n3    Alabama Barbour County          10518        53.45      45.79\n4    Alabama    Bibb County           9595        78.43      20.70\n5    Alabama  Blount County          27588        89.57       9.57\n6    Alabama Bullock County           4613        24.84      74.70\n  total_votes_16 dem_pct_16 repub_votes_20\n1          24661      23.96          19839\n2          94090      19.57          83542\n3          10390      46.66           5622\n4           8748      21.42           7525\n5          25384       8.47          24711\n6           4701      75.09           1146\n\n\n\n# What did this code do?\n# Give a Boolean value of if repub win this county and add a column of this\nelections_small |&gt;\n  mutate(repub_win_20 = repub_pct_20 &gt; dem_pct_20) |&gt;\n  head()\n\n  state_name    county_name total_votes_20 repub_pct_20 dem_pct_20\n1    Alabama Autauga County          27770        71.44      27.02\n2    Alabama Baldwin County         109679        76.17      22.41\n3    Alabama Barbour County          10518        53.45      45.79\n4    Alabama    Bibb County           9595        78.43      20.70\n5    Alabama  Blount County          27588        89.57       9.57\n6    Alabama Bullock County           4613        24.84      74.70\n  total_votes_16 dem_pct_16 repub_win_20\n1          24661      23.96         TRUE\n2          94090      19.57         TRUE\n3          10390      46.66         TRUE\n4           8748      21.42         TRUE\n5          25384       8.47         TRUE\n6           4701      75.09        FALSE\n\n\nPart b\n\n# You try\n# Define a variable that calculates the change in Dem support in 2020 vs 2016\nelections_small |&gt;\n mutate(diff_dem = dem_pct_20 - dem_pct_16 ) |&gt;\n head()\n\n  state_name    county_name total_votes_20 repub_pct_20 dem_pct_20\n1    Alabama Autauga County          27770        71.44      27.02\n2    Alabama Baldwin County         109679        76.17      22.41\n3    Alabama Barbour County          10518        53.45      45.79\n4    Alabama    Bibb County           9595        78.43      20.70\n5    Alabama  Blount County          27588        89.57       9.57\n6    Alabama Bullock County           4613        24.84      74.70\n  total_votes_16 dem_pct_16 diff_dem\n1          24661      23.96     3.06\n2          94090      19.57     2.84\n3          10390      46.66    -0.87\n4           8748      21.42    -0.72\n5          25384       8.47     1.10\n6           4701      75.09    -0.39\n\n\n\n# You try\n# Define a variable that determines whether the Dem support was higher in 2020 than in 2016 (TRUE/FALSE)\nelections_small |&gt;\n mutate(dem_up = dem_pct_20 &gt; dem_pct_16) |&gt;\n head()\n\n  state_name    county_name total_votes_20 repub_pct_20 dem_pct_20\n1    Alabama Autauga County          27770        71.44      27.02\n2    Alabama Baldwin County         109679        76.17      22.41\n3    Alabama Barbour County          10518        53.45      45.79\n4    Alabama    Bibb County           9595        78.43      20.70\n5    Alabama  Blount County          27588        89.57       9.57\n6    Alabama Bullock County           4613        24.84      74.70\n  total_votes_16 dem_pct_16 dem_up\n1          24661      23.96   TRUE\n2          94090      19.57   TRUE\n3          10390      46.66  FALSE\n4           8748      21.42  FALSE\n5          25384       8.47   TRUE\n6           4701      75.09  FALSE\n\n\nExercise 5: Pipe Series\nLet’s now combine these verbs into a pipe series!\nPart a\n\n\n\n\n\n\nThink then Run\n\n\n\nBEFORE running the below chunk, what do you think it will produce? Wisconsin counties where repub &lt; dem and from most votes to least votes\n\n\n\nelections_small |&gt;\n  filter(state_name == \"Wisconsin\",\n         repub_pct_20 &lt; dem_pct_20) |&gt;\n  arrange(desc(total_votes_20)) |&gt;\n  head()\n\n  state_name       county_name total_votes_20 repub_pct_20 dem_pct_20\n1  Wisconsin  Milwaukee County         458971        29.27      69.13\n2  Wisconsin       Dane County         344791        22.85      75.46\n3  Wisconsin       Rock County          85360        43.51      54.66\n4  Wisconsin  La Crosse County          67884        42.25      55.75\n5  Wisconsin Eau Claire County          58275        43.49      54.26\n6  Wisconsin    Portage County          40603        47.53      50.31\n  total_votes_16 dem_pct_16\n1         434970      66.44\n2         304729      71.38\n3          75043      52.42\n4          62785      51.61\n5          54080      50.43\n6          38123      48.59\n\n\nPart b\n\n\n\n\n\n\nThink then Run\n\n\n\nBEFORE trying, what do you think will happen if you change the order of filter and arrange:\n\nthe results will be the same\nwe’ll get an error\nwe won’t get an error, but the results will be different\n\n\n\n\n# Now try it. Change the order of filter and arrange below.\nelections_small |&gt;\n  filter(state_name == \"Wisconsin\",\n         repub_pct_20 &lt; dem_pct_20) |&gt;\n  arrange(desc(total_votes_20)) |&gt;\n  head()\n\n  state_name       county_name total_votes_20 repub_pct_20 dem_pct_20\n1  Wisconsin  Milwaukee County         458971        29.27      69.13\n2  Wisconsin       Dane County         344791        22.85      75.46\n3  Wisconsin       Rock County          85360        43.51      54.66\n4  Wisconsin  La Crosse County          67884        42.25      55.75\n5  Wisconsin Eau Claire County          58275        43.49      54.26\n6  Wisconsin    Portage County          40603        47.53      50.31\n  total_votes_16 dem_pct_16\n1         434970      66.44\n2         304729      71.38\n3          75043      52.42\n4          62785      51.61\n5          54080      50.43\n6          38123      48.59\n\n\nPart c\nSo the order of filter() and arrange() did not matter – rerranging them produces the same results. BUT what is one advantage of filtering before arranging?\nIt would take less time for the arrange to run with less data points.\nPart d\n\n\n\n\n\n\nThink then Run\n\n\n\nDelaware counties where repub_win Boolean value is mutated and rep pct 20, dem pct 20, rep win 20 will be selected.\n\n\n\nelections_small |&gt;\n  filter(state_name == \"Delaware\") |&gt;\n  mutate(repub_win_20 = repub_pct_20 &gt; dem_pct_20) |&gt;\n  select(county_name, repub_pct_20, dem_pct_20, repub_win_20)\n\n        county_name repub_pct_20 dem_pct_20 repub_win_20\n1       Kent County        47.12      51.19        FALSE\n2 New Castle County        30.72      67.81        FALSE\n3     Sussex County        55.07      43.82         TRUE\n\n\nPart e\n\n\n\n\n\n\nThink then Run\n\n\n\nBEFORE trying, what do you think will happen if you change the order of mutate and select:\n\nwe’ll get an error\n\n\n\n\n# Now try it. Change the order of mutate and select below.\n# elections_small |&gt;\n#   filter(state_name == \"Delaware\") |&gt;\n#   select(county_name, repub_pct_20, dem_pct_20, repub_win_20) |&gt;\n#   mutate(repub_win_20 = repub_pct_20 &gt; dem_pct_20) \n\nExercise 6: DIY Pipe Series\nWe’ve now learned 4 of the 6 wrangling verbs: select, filter, mutate, arrange. Let’s practice combining these into pipe series. Here are some hot tips:\n\nBefore writing any code, translate the prompt: how many distinct wrangling steps are needed and what verb do we need in each step?\nAdd each verb one at a time – don’t try writing a whole chunk at once.\n\nPart a\nShow just the counties in Minnesota and their Democratic 2020 vote percentage, from highest to lowest. Your answer should have just 2 columns.\n\nelections_small |&gt;\n  filter(state_name == \"Minnesota\") |&gt;\n  arrange(desc(dem_pct_20)) |&gt;\n  select(county_name, dem_pct_20)\n\n                county_name dem_pct_20\n1             Ramsey County      71.50\n2           Hennepin County      70.46\n3               Cook County      65.58\n4          St. Louis County      56.64\n5             Dakota County      55.73\n6            Olmsted County      54.16\n7         Washington County      53.46\n8         Blue Earth County      50.84\n9               Clay County      50.74\n10              Lake County      50.64\n11          Nicollet County      50.31\n12           Carlton County      49.58\n13            Winona County      49.07\n14              Rice County      48.76\n15          Mahnomen County      48.26\n16             Anoka County      47.79\n17          Beltrami County      47.24\n18            Carver County      46.37\n19             Mower County      46.00\n20             Scott County      45.52\n21           Houston County      42.42\n22           Goodhue County      41.23\n23          Freeborn County      40.96\n24            Norman County      40.80\n25            Itasca County      40.61\n26       Koochiching County      38.41\n27          Watonwan County      38.20\n28           Kittson County      38.12\n29           Stevens County      37.80\n30           Stearns County      37.58\n31          Fillmore County      37.48\n32            Steele County      37.47\n33         Kandiyohi County      36.12\n34            Aitkin County      35.98\n35              Lyon County      35.94\n36     Lac qui Parle County      35.79\n37           Wabasha County      35.78\n38             Grant County      35.58\n39          Traverse County      35.46\n40         Big Stone County      35.41\n41        Pennington County      35.29\n42              Pope County      35.27\n43              Polk County      34.88\n44              Cass County      34.68\n45            Wright County      34.49\n46           Hubbard County      34.42\n47             Swift County      34.35\n48         Crow Wing County      34.17\n49           Chisago County      34.15\n50            Becker County      33.96\n51              Pine County      33.87\n52          Le Sueur County      33.73\n53          Chippewa County      33.67\n54            Nobles County      33.65\n55            Waseca County      33.65\n56             Dodge County      33.47\n57        Otter Tail County      32.85\n58            Benton County      32.70\n59           Douglas County      32.56\n60             Brown County      32.48\n61         Sherburne County      32.48\n62         Faribault County      31.98\n63          Red Lake County      31.47\n64          Renville County      30.71\n65            McLeod County      30.64\n66   Yellow Medicine County      30.54\n67           Lincoln County      30.08\n68        Cottonwood County      30.03\n69           Kanabec County      30.02\n70            Martin County      30.02\n71           Jackson County      29.99\n72        Mille Lacs County      29.98\n73            Wilkin County      29.91\n74              Rock County      29.69\n75            Murray County      29.60\n76            Isanti County      29.45\n77            Sibley County      28.60\n78            Meeker County      28.58\n79           Redwood County      28.43\n80 Lake of the Woods County      27.87\n81        Clearwater County      26.76\n82         Pipestone County      26.44\n83            Wadena County      26.35\n84            Roseau County      25.98\n85          Marshall County      25.33\n86              Todd County      24.79\n87          Morrison County      22.33\n\n\nPart b\nCreate a new dataset named mn_wi that sorts the counties in Minnesota and Wisconsin from lowest to highest in terms of the change in Democratic vote percentage in 2020 vs 2016. This dataset should include the following variables (and only these variables): state_name, county_name, dem_pct_20, dem_pct_16, and a variable measuring the change in Democratic vote percentage in 2020 vs 2016.\n\n# Define the dataset\n# Only store the results once you're confident that they're correct\nmn_wi &lt;- elections |&gt;\n  select(state_name, county_name, dem_pct_20, dem_pct_16) |&gt;\n  filter(state_name == c(\"Minnesota\", \"Wisconsin\")) |&gt;\n  mutate(dem_pct_chg = dem_pct_20 - dem_pct_16) |&gt;\n  arrange(dem_pct_chg)\n\nWarning: There was 1 warning in `filter()`.\nℹ In argument: `state_name == c(\"Minnesota\", \"Wisconsin\")`.\nCaused by warning in `state_name == c(\"Minnesota\", \"Wisconsin\")`:\n! longer object length is not a multiple of shorter object length\n\n# Check out the first 6 rows to confirm your results\nhead(mn_wi, 6)\n\n  state_name        county_name dem_pct_20 dem_pct_16 dem_pct_chg\n1  Wisconsin       Clark County      30.37      31.19       -0.82\n2  Wisconsin Trempealeau County      40.86      41.57       -0.71\n3  Wisconsin     Buffalo County      36.59      36.57        0.02\n4  Minnesota    Traverse County      35.46      35.23        0.23\n5  Wisconsin     Kenosha County      47.55      47.17        0.38\n6  Minnesota        Pine County      33.87      33.36        0.51\n\n\nPart c\nConstruct and discuss a plot of the county-level change in Democratic vote percent in 2020 vs 2016, and how this differs between Minnesota and Wisconsin.\n\nggplot(mn_wi, aes(x = state_name, y = dem_pct_chg)) + geom_boxplot() + theme_minimal()\n\n\n\n\n\n\n\nMinnesota shifted blue more than wisconsin both by number of counties and percentage shifted.\nExercise 7: summarize Demo\n6 verbs: select, filter, arrange, mutate, summarize, group_by\nLet’s talk about the last 2 verbs. summarize() (or equivalently summarise()) takes an entire data frame as input and outputs a single row with one or more summary statistics. For each chunk below, indicate what the code does.\n\n# What does this do?\n# Find the median of rep support of all counties\nelections_small |&gt;\n  summarize(median(repub_pct_20))\n\n  median(repub_pct_20)\n1                68.29\n\n\n\n# What does this do?\n# Same thing\nelections_small |&gt;\n  summarize(median_repub = median(repub_pct_20))\n\n  median_repub\n1        68.29\n\n\n\n# What does this do?\n# Sum all rep votes\nelections_small |&gt;\n  summarize(median_repub = median(repub_pct_20), total_votes = sum(total_votes_20))\n\n  median_repub total_votes\n1        68.29   157949293\n\n\nExercise 8: summarize + group_by demo\nFinally, group_by() groups the units of observation or rows of a data frame by a specified set of variables. Alone, this function doesn’t change the appearance of our dataset or seem to do anything at all:\n\nelections_small |&gt;\n  group_by(state_name)\n\n# A tibble: 3,109 × 7\n# Groups:   state_name [50]\n   state_name county_name  total_votes_20 repub_pct_20 dem_pct_20 total_votes_16\n   &lt;chr&gt;      &lt;chr&gt;                 &lt;int&gt;        &lt;dbl&gt;      &lt;dbl&gt;          &lt;int&gt;\n 1 Alabama    Autauga Cou…          27770         71.4      27.0           24661\n 2 Alabama    Baldwin Cou…         109679         76.2      22.4           94090\n 3 Alabama    Barbour Cou…          10518         53.4      45.8           10390\n 4 Alabama    Bibb County            9595         78.4      20.7            8748\n 5 Alabama    Blount Coun…          27588         89.6       9.57          25384\n 6 Alabama    Bullock Cou…           4613         24.8      74.7            4701\n 7 Alabama    Butler Coun…           9488         57.5      41.8            8685\n 8 Alabama    Calhoun Cou…          50983         68.8      29.8           47376\n 9 Alabama    Chambers Co…          15284         57.3      41.6           13778\n10 Alabama    Cherokee Co…          12301         86.0      13.2           10503\n# ℹ 3,099 more rows\n# ℹ 1 more variable: dem_pct_16 &lt;dbl&gt;\n\n\nThough it does change the underlying structure of the dataset:\n\n# Check out the structure before and after group_by\nelections_small |&gt;\n  class()\n\n[1] \"data.frame\"\n\nelections_small |&gt;\n  group_by(state_name) |&gt;\n  class()\n\n[1] \"grouped_df\" \"tbl_df\"     \"tbl\"        \"data.frame\"\n\n\nWhere it really shines is in partnership with summarize().\n\n# What does this do?\n# (What if we didn't use group_by?)\nelections_small |&gt;\n  group_by(state_name) |&gt;\n  summarize(median_repub = median(repub_pct_20), total_votes = sum(total_votes_20))\n\n# A tibble: 50 × 3\n   state_name           median_repub total_votes\n   &lt;chr&gt;                       &lt;dbl&gt;       &lt;int&gt;\n 1 Alabama                      70.6     2323304\n 2 Arizona                      57.9     3387326\n 3 Arkansas                     72.1     1219069\n 4 California                   44.8    17495906\n 5 Colorado                     56.2     3256953\n 6 Connecticut                  41.0     1824280\n 7 Delaware                     47.1      504010\n 8 District of Columbia          5.4      344356\n 9 Florida                      64.6    11067456\n10 Georgia                      68       4997716\n# ℹ 40 more rows\n\n\n\n\n\n\n\n\nReflect\n\n\n\nNotice that group_by() with summarize() produces new data frame or tibble! But the units of observation are now states instead of counties within states.\n\n\nExercise 9: DIY\nLet’s practice (some of) our 6 verbs: select, filter, arrange, mutate, summarize, group_by Remember:\n\nBefore writing any code, translate the given prompts: how many distinct wrangling steps are needed and what verb do we need in each step?\nAdd each verb one at a time.\n\nPart a\nNOTE: Part a is a challenge exercise. If you get really stuck, move on to Part b which is the same overall question, but with hints.\n\n# Sort the *states* from the most to least total votes cast in 2020\nelections_small |&gt; \n  group_by(state_name) |&gt;\n  summarise(total = sum(total_votes_20)) |&gt;\n  arrange(desc(total))\n\n# A tibble: 50 × 2\n   state_name        total\n   &lt;chr&gt;             &lt;int&gt;\n 1 California     17495906\n 2 Texas          11317911\n 3 Florida        11067456\n 4 New York        8616205\n 5 Pennsylvania    6925255\n 6 Illinois        6038850\n 7 Ohio            5922202\n 8 Michigan        5539302\n 9 North Carolina  5524801\n10 Georgia         4997716\n# ℹ 40 more rows\n\n\n\n# In 2020, what were the total number of votes for the Democratic candidate and the total number of votes for the Republican candidate in each *state*?\nelections_small |&gt; \n  mutate(total_rep = repub_pct_20 * total_votes_20, total_dem = dem_pct_20 * total_votes_20) |&gt;\n  group_by(state_name) |&gt;\n  summarise(rep_votes = sum(total_rep), dem_votes = sum(total_dem))\n\n# A tibble: 50 × 3\n   state_name            rep_votes   dem_votes\n   &lt;chr&gt;                     &lt;dbl&gt;       &lt;dbl&gt;\n 1 Alabama              144115325.   84966521.\n 2 Arizona              166167238.  167212561.\n 3 Arkansas              76063890.   42391888.\n 4 California           600603367. 1110964299.\n 5 Colorado             136462476.  180439477.\n 6 Connecticut           71531461.  108067747.\n 7 Delaware              20060118.   29627408.\n 8 District of Columbia   1859522.   31732405.\n 9 Florida              566859937.  529712890.\n10 Georgia              246187098.  247365644.\n# ℹ 40 more rows\n\n\n\n# What states did the Democratic candidate win in 2020?\nelections_small |&gt; \n  mutate(total_rep = repub_pct_20 * total_votes_20, total_dem = dem_pct_20 * total_votes_20) |&gt;\n  group_by(state_name) |&gt;\n  summarise(rep_votes = sum(total_rep), dem_votes = sum(total_dem)) |&gt;\n  mutate(dem_win = (dem_votes &gt; rep_votes))\n\n# A tibble: 50 × 4\n   state_name            rep_votes   dem_votes dem_win\n   &lt;chr&gt;                     &lt;dbl&gt;       &lt;dbl&gt; &lt;lgl&gt;  \n 1 Alabama              144115325.   84966521. FALSE  \n 2 Arizona              166167238.  167212561. TRUE   \n 3 Arkansas              76063890.   42391888. FALSE  \n 4 California           600603367. 1110964299. TRUE   \n 5 Colorado             136462476.  180439477. TRUE   \n 6 Connecticut           71531461.  108067747. TRUE   \n 7 Delaware              20060118.   29627408. TRUE   \n 8 District of Columbia   1859522.   31732405. TRUE   \n 9 Florida              566859937.  529712890. FALSE  \n10 Georgia              246187098.  247365644. TRUE   \n# ℹ 40 more rows\n\n\nPart b\n\n# Sort the states from the most to least total votes cast in 2020\n# HINT: Calculate the total number of votes in each state, then sort\nelections_small |&gt; \n  group_by(state_name) |&gt;\n  summarise(total = sum(total_votes_20)) |&gt;\n  arrange(desc(total))\n\n# A tibble: 50 × 2\n   state_name        total\n   &lt;chr&gt;             &lt;int&gt;\n 1 California     17495906\n 2 Texas          11317911\n 3 Florida        11067456\n 4 New York        8616205\n 5 Pennsylvania    6925255\n 6 Illinois        6038850\n 7 Ohio            5922202\n 8 Michigan        5539302\n 9 North Carolina  5524801\n10 Georgia         4997716\n# ℹ 40 more rows\n\n\n\n# In 2020, what were the total number of votes for the Democratic candidate and the total number of votes for the Republican candidate in each state?\n# HINT: First calculate the number of Dem and Repub votes in each *county*\n# Then group and summarize these by state\nelections_small |&gt; \n  mutate(total_rep = repub_pct_20 * total_votes_20, total_dem = dem_pct_20 * total_votes_20) |&gt;\n  group_by(state_name) |&gt;\n  summarise(rep_votes = sum(total_rep), dem_votes = sum(total_dem))\n\n# A tibble: 50 × 3\n   state_name            rep_votes   dem_votes\n   &lt;chr&gt;                     &lt;dbl&gt;       &lt;dbl&gt;\n 1 Alabama              144115325.   84966521.\n 2 Arizona              166167238.  167212561.\n 3 Arkansas              76063890.   42391888.\n 4 California           600603367. 1110964299.\n 5 Colorado             136462476.  180439477.\n 6 Connecticut           71531461.  108067747.\n 7 Delaware              20060118.   29627408.\n 8 District of Columbia   1859522.   31732405.\n 9 Florida              566859937.  529712890.\n10 Georgia              246187098.  247365644.\n# ℹ 40 more rows\n\n\n\n# What states did the Democratic candidate win in 2020?\n# HINT: Start with the results from the previous chunk, and then keep only some rows\nelections_small |&gt; \n  mutate(total_rep = repub_pct_20 * total_votes_20, total_dem = dem_pct_20 * total_votes_20) |&gt;\n  group_by(state_name) |&gt;\n  summarise(rep_votes = sum(total_rep), dem_votes = sum(total_dem)) |&gt;\n  mutate(dem_win = (dem_votes &gt; rep_votes))\n\n# A tibble: 50 × 4\n   state_name            rep_votes   dem_votes dem_win\n   &lt;chr&gt;                     &lt;dbl&gt;       &lt;dbl&gt; &lt;lgl&gt;  \n 1 Alabama              144115325.   84966521. FALSE  \n 2 Arizona              166167238.  167212561. TRUE   \n 3 Arkansas              76063890.   42391888. FALSE  \n 4 California           600603367. 1110964299. TRUE   \n 5 Colorado             136462476.  180439477. TRUE   \n 6 Connecticut           71531461.  108067747. TRUE   \n 7 Delaware              20060118.   29627408. TRUE   \n 8 District of Columbia   1859522.   31732405. TRUE   \n 9 Florida              566859937.  529712890. FALSE  \n10 Georgia              246187098.  247365644. TRUE   \n# ℹ 40 more rows\n\n\nExercise 10: Practice on New Data\nRecall the World Cup football/soccer data from TidyTuesday:\n\nworld_cup &lt;- read.csv(\"https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-11-29/worldcups.csv\")\n\nYou can find a codebook here. Use (some of) our 6 verbs (select, filter, arrange, mutate, summarize, group_by) and data viz to address the following prompts.\n\n# In what years did Brazil win the World Cup?\nworld_cup |&gt;\n  filter(winner == \"Brazil\")\n\n  year               host winner         second        third       fourth\n1 1958             Sweden Brazil         Sweden       France West Germany\n2 1962              Chile Brazil Czechoslovakia        Chile   Yugoslavia\n3 1970             Mexico Brazil          Italy West Germany      Uruguay\n4 1994                USA Brazil          Italy       Sweden     Bulgaria\n5 2002 Japan, South Korea Brazil        Germany       Turkey  South Korea\n  goals_scored teams games attendance\n1          126    16    35     868000\n2           89    16    32     776000\n3           95    16    32    1673975\n4          141    24    52    3568567\n5          161    32    64    2724604\n\n\n\n# What were the 6 World Cups with the highest attendance?\nworld_cup |&gt;\n  arrange(desc(attendance)) |&gt;\n  head(6)\n\n  year               host  winner    second       third      fourth\n1 1994                USA  Brazil     Italy      Sweden    Bulgaria\n2 2014             Brazil Germany Argentina Netherlands      Brazil\n3 2006            Germany   Italy    France     Germany    Portugal\n4 2018             Russia  France   Croatia     Belgium     England\n5 1998             France  France    Brazil     Croatia Netherlands\n6 2002 Japan, South Korea  Brazil   Germany      Turkey South Korea\n  goals_scored teams games attendance\n1          141    24    52    3568567\n2          171    32    64    3441450\n3          147    32    64    3367000\n4          169    32    64    3031768\n5          171    32    64    2859234\n6          161    32    64    2724604\n\n\n\n# Construct a univariate plot of goals_scored (no wrangling necessary)\n# This provides a visual summary of how the number of goals_scored varies from World Cup to World Cup\n\nggplot(world_cup, aes(x = goals_scored)) + geom_histogram(color = \"white\")\n\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n\n\n\n\n\n\n\n\n\n# Let's follow up the plot with some more precise numerical summaries\n# Calculate the min, median, and max number of goals_scored across all World Cups\n# NOTE: Visually compare these numerical summaries to what you observed in the plot\nworld_cup |&gt;\n  summarise(min(goals_scored), max(goals_scored), median(goals_scored))\n\n  min(goals_scored) max(goals_scored) median(goals_scored)\n1                70               171                  126\n\n\n\n# Construct a bivariate plot of how the number of goals_scored in the World Cup has changed over the years\n# No wrangling necessary\nggplot(world_cup, aes(x = year, y = goals_scored)) + geom_point() + geom_line()\n\n\n\n\n\n\n\n\n# Our above summaries might be a bit misleading.\n# The number of games played at the World Cup varies.\n# Construct a bivariate plot of how the typical number of goals per game has changed over the years\nggplot(world_cup, aes(x = year, y = goals_scored/games)) + geom_point() + geom_line()\n\n\n\n\n\n\n\nExercise 11: Practice on Your Data\nReturn to the TidyTuesday data you’re using in Homework 3. Use your new wrangling skills to play around. What new insights can you gain?!",
    "crumbs": [
      "In-class Activities",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Wrangling</span>"
    ]
  },
  {
    "objectID": "ica/ica-dates.html",
    "href": "ica/ica-dates.html",
    "title": "\n17  Dates\n",
    "section": "",
    "text": "Exercise 1: More Filtering\nRecall the “logical comparison operators” we can use to filter() our data:",
    "crumbs": [
      "In-class Activities",
      "<span class='chapter-number'>17</span>  <span class='chapter-title'>Dates</span>"
    ]
  },
  {
    "objectID": "ica/ica-dates.html#exercises-part-2-application",
    "href": "ica/ica-dates.html#exercises-part-2-application",
    "title": "\n17  Dates\n",
    "section": "\n17.1 Exercises Part 2: Application",
    "text": "17.1 Exercises Part 2: Application\nThe remaining exercises are similar to some of those on the homework. Hence, the solutions are not provided. Let’s apply these ideas to the daily Birthdays dataset in the mosaic package.\n\nlibrary(mosaic)\n\nRegistered S3 method overwritten by 'mosaic':\n  method                           from   \n  fortify.SpatialPolygonsDataFrame ggplot2\n\n\n\nThe 'mosaic' package masks several functions from core packages in order to add \nadditional features.  The original behavior of these functions should not be affected by this.\n\n\n\nAttaching package: 'mosaic'\n\n\nThe following object is masked from 'package:Matrix':\n\n    mean\n\n\nThe following objects are masked from 'package:dplyr':\n\n    count, do, tally\n\n\nThe following object is masked from 'package:purrr':\n\n    cross\n\n\nThe following object is masked from 'package:ggplot2':\n\n    stat\n\n\nThe following objects are masked from 'package:stats':\n\n    binom.test, cor, cor.test, cov, fivenum, IQR, median, prop.test,\n    quantile, sd, t.test, var\n\n\nThe following objects are masked from 'package:base':\n\n    max, mean, min, prod, range, sample, sum\n\ndata(\"Birthdays\")\nhead(Birthdays)\n\n  state year month day       date wday births\n1    AK 1969     1   1 1969-01-01  Wed     14\n2    AL 1969     1   1 1969-01-01  Wed    174\n3    AR 1969     1   1 1969-01-01  Wed     78\n4    AZ 1969     1   1 1969-01-01  Wed     84\n5    CA 1969     1   1 1969-01-01  Wed    824\n6    CO 1969     1   1 1969-01-01  Wed    100\n\n\nBirthdays gives the number of births recorded on each day of the year in each state from 1969 to 19881. We can use our wrangling skills to understand some drivers of daily births. Putting these all together can be challenging! Remember the following ways to make tasks more manageable:\n\nTranslate the prompt into our 6 verbs (and count()). That is, think before you type.\nBuild your code line by line. It’s important to understand what’s being piped into each function!\n\nExercise 5: Warming up\n\n# How many days of data do we have for each state?\nBirthdays |&gt;\n  group_by(state)|&gt;\n  count(state)\n\n# A tibble: 51 × 2\n# Groups:   state [51]\n   state     n\n   &lt;chr&gt; &lt;int&gt;\n 1 AK     7306\n 2 AL     7312\n 3 AR     7310\n 4 AZ     7310\n 5 CA     7325\n 6 CO     7305\n 7 CT     7312\n 8 DC     7311\n 9 DE     7307\n10 FL     7307\n# ℹ 41 more rows\n\n# How many total births were there in this time period?\nBirthdays |&gt;\n  summarise(sum(births))\n\n  sum(births)\n1    70486538\n\n# How many total births were there per state in this time period, sorted from low to high?\nBirthdays |&gt;\n  group_by(state)|&gt;\n  summarise(total_births = sum(births))|&gt;\n  arrange(total_births)\n\n# A tibble: 51 × 2\n   state total_births\n   &lt;chr&gt;        &lt;int&gt;\n 1 VT          147886\n 2 WY          154019\n 3 AK          185385\n 4 DE          188705\n 5 SD          235734\n 6 ND          238696\n 7 NV          241470\n 8 MT          253884\n 9 NH          264984\n10 RI          265038\n# ℹ 41 more rows\n\n\nExercise 6: Homework Reprise\nCreate a new dataset named daily_births that includes the total number of births per day (across all states) and the corresponding day of the week, eg, Mon. NOTE: Name the column with total births so that it’s easier to wrangle and plot.\n\ndaily_births &lt;- Birthdays |&gt;\n  group_by(date) |&gt;\n  summarize(total_birth = sum(births)) |&gt;\n  mutate(DofW = wday(date, label = TRUE))\n\nUsing this data, construct a plot of births over time, indicating the day of week.\n\nggplot(daily_births, aes(x = DofW, y = total_birth)) + geom_boxplot()\n\n\n\n\n\n\n\nExercise 7: Wrangle & Plot\nFor each prompt below, you can decide whether you want to: (1) wrangle and store data, then plot; or (2) wrangle data and pipe directly into ggplot. For example:\n\npenguins |&gt; \n  filter(species != \"Gentoo\") |&gt; \n  ggplot(aes(y = bill_length_mm, x = bill_depth_mm, color = species)) + \n    geom_point()\n\nWarning: Removed 1 row containing missing values or values outside the scale range\n(`geom_point()`).\n\n\n\n\n\n\n\n\nPart a\nCalculate the total number of births in each month and year, eg, Jan 1969, Feb 1969, …. Label month by names not numbers, eg, Jan not 1. Then, plot the births by month and comment on what you learn.\n\nBirthdays |&gt;\n  group_by(year, month)|&gt;\n  summarise(total_births = sum(births))|&gt;\n  mutate(month = month(month, label = TRUE)) |&gt;\n  ggplot(aes(x=month, y=total_births))+geom_boxplot()\n\n`summarise()` has grouped output by 'year'. You can override using the\n`.groups` argument.\n\n\n\n\n\n\n\n# I learned that Jul - Sep has much more births.\n\nPart b\nIn 1988, calculate the total number of births per week in each state. Get rid of week “53”, which isn’t a complete week! Then, make a line plot of births by week for each state and comment on what you learn. For example, do you notice any seasonal trends? Are these the same in every state? Any outliers?\n\nBirthdays |&gt;\n  mutate(week = week(date))|&gt;\n  filter(year == 1988, week != 53)|&gt;\n  group_by(week)|&gt;\n  summarise(total_births = sum(births))|&gt;\n  ggplot(aes(x=week, y=total_births))+geom_point()+geom_line()\n\n\n\n\n\n\n#Seasonal trend is similiar with the one above. Outlier is 18th week and 36th week.\n\nPart c\nRepeat the above for just Minnesota (MN) and Louisiana (LA). MN has one of the coldest climates and LA has one of the warmest. How do their seasonal trends compare? Do you think these trends are similar in other colder and warmer states? Try it!\n\nBirthdays |&gt;\n  mutate(week = week(date))|&gt;\n  filter(year == 1988, week != 53, state == c(\"LA\", \"MN\"))|&gt;\n  group_by(week, state)|&gt;\n  summarise(total_births = sum(births))|&gt;\n  ggplot(aes(x=week, y=total_births, color = state))+geom_point()+geom_line()\n\n`summarise()` has grouped output by 'week'. You can override using the\n`.groups` argument.\n\n\n\n\n\n\n\n# Trend is smore significant in warmer states. In MN, fall increase isn't significant.\n\nExercise 8: More Practice\nPart a\nCreate a dataset with only births in Massachusetts (MA) in 1979 and sort the days from those with the most births to those with the fewest.\n\nma1979 &lt;- Birthdays |&gt;\n  filter(year == 1979, state == \"MA\")|&gt;\n  arrange(desc(births))\n\nPart b\nMake a table showing the five states with the most births between September 9, 1979 and September 12, 1979, including the 9th and 12th. Arrange the table in descending order of births.\n\nBirthdays |&gt;\n  filter(year == 1979, month == 9, day %in% c(9, 10, 11 ,12))|&gt;\n  group_by(state)|&gt;\n  summarise(total = sum(births))|&gt;\n  arrange(desc(total))|&gt;\n  head(5)\n\n# A tibble: 5 × 2\n  state total\n  &lt;chr&gt; &lt;int&gt;\n1 CA     4422\n2 TX     3151\n3 NY     2621\n4 IL     2235\n5 OH     1938",
    "crumbs": [
      "In-class Activities",
      "<span class='chapter-number'>17</span>  <span class='chapter-title'>Dates</span>"
    ]
  },
  {
    "objectID": "ica/ica-dates.html#footnotes",
    "href": "ica/ica-dates.html#footnotes",
    "title": "\n17  Dates\n",
    "section": "",
    "text": "The fivethirtyeight package has more recent data.↩︎",
    "crumbs": [
      "In-class Activities",
      "<span class='chapter-number'>17</span>  <span class='chapter-title'>Dates</span>"
    ]
  },
  {
    "objectID": "ica/ica-reshaping.html",
    "href": "ica/ica-reshaping.html",
    "title": "\n18  Reshaping\n",
    "section": "",
    "text": "Exercise 1: What’s the problem?\nConsider data on a sleep study in which subjects received only 3 hours of sleep per night. Each day, their reaction time to a stimulus (in ms) was recorded.1\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nsleep_wide &lt;- read.csv(\"https://mac-stat.github.io/data/sleep_wide.csv\")\n\nhead(sleep_wide)\n\n  Subject  day_0  day_1  day_2  day_3  day_4  day_5  day_6  day_7  day_8  day_9\n1     308 249.56 258.70 250.80 321.44 356.85 414.69 382.20 290.15 430.59 466.35\n2     309 222.73 205.27 202.98 204.71 207.72 215.96 213.63 217.73 224.30 237.31\n3     310 199.05 194.33 234.32 232.84 229.31 220.46 235.42 255.75 261.01 247.52\n4     330 321.54 300.40 283.86 285.13 285.80 297.59 280.24 318.26 305.35 354.05\n5     331 287.61 285.00 301.82 320.12 316.28 293.32 290.08 334.82 293.75 371.58\n6     332 234.86 242.81 272.96 309.77 317.46 310.00 454.16 346.83 330.30 253.86",
    "crumbs": [
      "In-class Activities",
      "<span class='chapter-number'>18</span>  <span class='chapter-title'>Reshaping</span>"
    ]
  },
  {
    "objectID": "ica/ica-reshaping.html#footnotes",
    "href": "ica/ica-reshaping.html#footnotes",
    "title": "\n18  Reshaping\n",
    "section": "",
    "text": "Gregory Belenky, Nancy J. Wesensten, David R. Thorne, Maria L. Thomas, Helen C. Sing, Daniel P. Redmond, Michael B. Russo and Thomas J. Balkin (2003) Patterns of performance degradation and restoration during sleep restriction and subsequent recovery: a sleep dose-response study. Journal of Sleep Research 12, 1–12.↩︎",
    "crumbs": [
      "In-class Activities",
      "<span class='chapter-number'>18</span>  <span class='chapter-title'>Reshaping</span>"
    ]
  },
  {
    "objectID": "ica/ica-joining.html",
    "href": "ica/ica-joining.html",
    "title": "\n19  Joining\n",
    "section": "",
    "text": "Exercise 1: Where are my keys?\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\n\nPart a\nDefine two new datasets, with different students and courses:\n\nstudents_2 &lt;- data.frame(\n  student = c(\"D\", \"E\", \"F\"),\n  class = c(\"COMP 101\", \"BIOL 101\", \"POLI 101\")\n)\n\n# Check it out\nstudents_2\n\n  student    class\n1       D COMP 101\n2       E BIOL 101\n3       F POLI 101\n\nenrollments_2 &lt;- data.frame(\n  course = c(\"ART 101\", \"BIOL 101\", \"COMP 101\"),\n  enrollment = c(18, 20, 19)\n)\n\n# Check it out\nenrollments_2\n\n    course enrollment\n1  ART 101         18\n2 BIOL 101         20\n3 COMP 101         19\n\n\nTo connect the course enrollments to the students’ courses, try do a left_join(). You get an error! Identify the problem by reviewing the error message and the datasets we’re trying to join.\n\n# eval = FALSE: don't evaluate this chunk when knitting. it produces an error.\nstudents_2 |&gt; \n  left_join(enrollments_2)\n\nPart b\nThe problem is that course name, the key or variable that links these two datasets, is labeled differently: class in the students_2 data and course in the enrollments_2 data. Thus we have to specify these keys in our code:\n\nstudents_2 |&gt; \n  left_join(enrollments_2, join_by(class == course))\n\n  student    class enrollment\n1       D COMP 101         19\n2       E BIOL 101         20\n3       F POLI 101         NA\n\n\n\n# The order of the keys is important:\n# join_by(\"left data key\" == \"right data key\")\n# The order is mixed up here, thus we get an error:\nstudents_2 |&gt; \n  left_join(enrollments_2, join_by(course == class))\n\nPart c\nDefine another set of fake data which adds grade information:\n\n# Add student grades in each course\nstudents_3 &lt;- data.frame(\n  student = c(\"Y\", \"Y\", \"Z\", \"Z\"),\n  class = c(\"COMP 101\", \"BIOL 101\", \"POLI 101\", \"COMP 101\"),\n  grade = c(\"B\", \"S\", \"C\", \"A\")\n)\n\n# Check it out\nstudents_3\n\n  student    class grade\n1       Y COMP 101     B\n2       Y BIOL 101     S\n3       Z POLI 101     C\n4       Z COMP 101     A\n\n# Add average grades in each course\nenrollments_3 &lt;- data.frame(\n  class = c(\"ART 101\", \"BIOL 101\",\"COMP 101\"),\n  grade = c(\"B\", \"A\", \"A-\"),\n  enrollment = c(20, 18, 19)\n)\n\n# Check it out\nenrollments_3\n\n     class grade enrollment\n1  ART 101     B         20\n2 BIOL 101     A         18\n3 COMP 101    A-         19\n\n\nTry doing a left_join() to link the students’ classes to their enrollment info. Did this work? Try and figure out the culprit by examining the output.\n\nstudents_3 |&gt; \n  left_join(enrollments_3)\n\nJoining with `by = join_by(class, grade)`\n\n\n  student    class grade enrollment\n1       Y COMP 101     B         NA\n2       Y BIOL 101     S         NA\n3       Z POLI 101     C         NA\n4       Z COMP 101     A         NA\n\n\nPart d\nThe issue here is that our datasets have 2 column names in common: class and grade. BUT grade is measuring 2 different things here: individual student grades in students_3 and average student grades in enrollments_3. Thus it doesn’t make sense to try to join the datasets with respect to this variable. We can again solve this by specifying that we want to join the datasets using the class variable as a key. What are grade.x and grade.y?\n\nstudents_3 |&gt; \n  left_join(enrollments_3, join_by(class == class))\n\n  student    class grade.x grade.y enrollment\n1       Y COMP 101       B      A-         19\n2       Y BIOL 101       S       A         18\n3       Z POLI 101       C    &lt;NA&gt;         NA\n4       Z COMP 101       A      A-         19\n\n\nExercise 2: More small practice\nBefore applying these ideas to bigger datasets, let’s practice identifying which join is appropriate in different scenarios. Define the following fake data on voters (people who have voted) and contact info for voting age adults (people who could vote):\n\n# People who have voted\nvoters &lt;- data.frame(\n  id = c(\"A\", \"D\", \"E\", \"F\", \"G\"),\n  times_voted = c(2, 4, 17, 6, 20)\n)\n\nvoters\n\n  id times_voted\n1  A           2\n2  D           4\n3  E          17\n4  F           6\n5  G          20\n\n# Contact info for voting age adults\ncontact &lt;- data.frame(\n  name = c(\"A\", \"B\", \"C\", \"D\"),\n  address = c(\"summit\", \"grand\", \"snelling\", \"fairview\"),\n  age = c(24, 89, 43, 38)\n)\n\ncontact\n\n  name  address age\n1    A   summit  24\n2    B    grand  89\n3    C snelling  43\n4    D fairview  38\n\n\nUse the appropriate join for each prompt below. In each case, think before you type:\n\nWhat dataset goes on the left?\nWhat do you want the resulting dataset to look like? How many rows and columns will it have?\n\n\n# 1. We want contact info for people who HAVEN'T voted\n\n\n# 2. We want contact info for people who HAVE voted\n\n\n# 3. We want any data available on each person\n\n\n# 4. When possible, we want to add contact info to the voting roster\n\nExercise 3: Bigger datasets\nLet’s apply these ideas to some bigger datasets. In grades, each row is a student-class pair with information on:\n\n\nsid = student ID\n\ngrade = student’s grade\n\nsessionID = an identifier of the class section\n\n\n# Get rid of some duplicate rows!\ngrades &lt;- read.csv(\"https://mac-stat.github.io/data/grades.csv\") |&gt; \n  distinct(sid, sessionID, .keep_all = TRUE)\nhead(grades)\n\n     sid grade   sessionID\n1 S31185    D+ session1784\n2 S31185    B+ session1785\n3 S31185    A- session1791\n4 S31185    B+ session1792\n5 S31185    B- session1794\n6 S31185    C+ session1795\n\n\nIn courses, each row corresponds to a class section with information on:\n\n\nsessionID = an identifier of the class section\n\ndept = department\n\nlevel = course level (eg: 100)\n\nsem = semester\n\nenroll = enrollment (number of students)\n\niid = instructor ID\n\n\n\n    sessionID dept level    sem enroll     iid\n1 session1784    M   100 FA1991     22 inst265\n2 session1785    k   100 FA1991     52 inst458\n3 session1791    J   100 FA1993     22 inst223\n4 session1792    J   300 FA1993     20 inst235\n5 session1794    J   200 FA1993     22 inst234\n6 session1795    J   200 SP1994     26 inst230\n\n\nUse R code to take a quick glance at the data.\n\n# How many observations (rows) and variables (columns) are there in the grades data?\n\n\n# How many observations (rows) and variables (columns) are there in the courses data?\n\nExercise 4: Class size\nHow big are the classes?\nPart a\nBefore digging in, note that some courses are listed twice in the courses data:\n\ncourses |&gt; \n  count(sessionID) |&gt; \n  filter(n &gt; 1)\n\n     sessionID n\n1  session2047 2\n2  session2067 2\n3  session2448 2\n4  session2509 2\n5  session2541 2\n6  session2824 2\n7  session2826 2\n8  session2862 2\n9  session2897 2\n10 session3046 2\n11 session3057 2\n12 session3123 2\n13 session3243 2\n14 session3257 2\n15 session3387 2\n16 session3400 2\n17 session3414 2\n18 session3430 2\n19 session3489 2\n20 session3524 2\n21 session3629 2\n22 session3643 2\n23 session3821 2\n\n\nIf we pick out just 1 of these, we learn that some courses are cross-listed in multiple departments:\n\ncourses |&gt; \n  filter(sessionID == \"session2047\")\n\n    sessionID dept level    sem enroll     iid\n1 session2047    g   100 FA2001     12 inst436\n2 session2047    m   100 FA2001     28 inst436\n\n\nFor our class size exploration, obtain the total enrollments in each sessionID, combining any cross-listed sections. Save this as courses_combined. NOTE: There’s no joining to do here!\n\n# courses_combined &lt;- courses |&gt; \n#   ___(sessionID) |&gt; \n#   ___(enroll = sum(___))\n\n# Check that this has 1695 rows and 2 columns\n# dim(courses_combined)\n\nPart b\nLet’s first examine the question of class size from the administration’s viewpoint. To this end, calculate the median class size across all class sections. (The median is the middle or 50th percentile. Unlike the mean, it’s not skewed by outliers.) THINK FIRST:\n\nWhich of the 2 datasets do you need to answer this question? One? Both?\nIf you need course information, use courses_combined not courses.\nDo you have to do any joining? If so, which dataset will go on the left, i.e. which dataset includes your primary observations of interest? Which join function will you need?\nPart c\nBut how big are classes from the student perspective? To this end, calculate the median class size for each individual student. Once you have the correct output, store it as student_class_size. THINK FIRST:\n\nWhich of the 2 datasets do you need to answer this question? One? Both?\nIf you need course information, use courses_combined not courses.\nDo you have to do any joining? If so, which dataset will go on the left, i.e. which dataset includes your primary observations of interest? Which join function will you need?\nPart d\nThe median class size varies from student to student. To get a sense for the typical student experience and range in student experiences, construct and discuss a histogram of the median class sizes experienced by the students.\n\n# ggplot(student_class_size, aes(x = ___)) + \n#   geom___()\n\nExercise 5: Narrowing in on classes\nPart a\nShow data on the students that enrolled in session1986. THINK FIRST: Which of the 2 datasets do you need to answer this question? One? Both?\nPart b\nBelow is a dataset with all courses in department E:\n\ndept_E &lt;- courses |&gt; \n  filter(dept == \"E\")\n\nWhat students enrolled in classes in department E? (We just want info on the students, not the classes.)\nExercise 6: All the wrangling\nUse all of your wrangling skills to answer the following prompts! THINK FIRST:\n\nThink about what tables you might need to join (if any). Identify the corresponding variables to match.\nYou’ll need an extra table to convert grades to grade point averages:\n\n\ngpa_conversion &lt;- tibble(\n  grade = c(\"A+\", \"A\", \"A-\", \"B+\", \"B\", \"B-\", \"C+\", \"C\", \"C-\", \"D+\", \"D\", \"D-\", \"NC\", \"AU\", \"S\"), \n  gp = c(4.3, 4, 3.7, 3.3, 3, 2.7, 2.3, 2, 1.7, 1.3, 1, 0.7, 0, NA, NA)\n)\n\ngpa_conversion\n\n# A tibble: 15 × 2\n   grade    gp\n   &lt;chr&gt; &lt;dbl&gt;\n 1 A+      4.3\n 2 A       4  \n 3 A-      3.7\n 4 B+      3.3\n 5 B       3  \n 6 B-      2.7\n 7 C+      2.3\n 8 C       2  \n 9 C-      1.7\n10 D+      1.3\n11 D       1  \n12 D-      0.7\n13 NC      0  \n14 AU     NA  \n15 S      NA  \n\n\nPart a\nHow many total student enrollments are there in each department? Order from high to low.\nPart b\nWhat’s the grade-point average (GPA) for each student?\nPart c\nWhat’s the median GPA across all students?\nPart d\nWhat fraction of grades are below B+?\nPart e\nWhat’s the grade-point average for each instructor? Order from low to high.\nPart f\nCHALLENGE: Estimate the grade-point average for each department, and sort from low to high. NOTE: Don’t include cross-listed courses. Students in cross-listed courses could be enrolled under either department, and we do not know which department to assign the grade to. HINT: You’ll need to do multiple joins.",
    "crumbs": [
      "In-class Activities",
      "<span class='chapter-number'>19</span>  <span class='chapter-title'>Joining</span>"
    ]
  },
  {
    "objectID": "ica/ica-factors.html",
    "href": "ica/ica-factors.html",
    "title": "\n20  Factors\n",
    "section": "",
    "text": "The exercises revisit our grades data:\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\n# Get rid of some duplicate rows!\ngrades &lt;- read.csv(\"https://mac-stat.github.io/data/grades.csv\") |&gt; \n  distinct(sid, sessionID, .keep_all = TRUE)\n\n# Check it out\nhead(grades)\n\n     sid grade   sessionID\n1 S31185    D+ session1784\n2 S31185    B+ session1785\n3 S31185    A- session1791\n4 S31185    B+ session1792\n5 S31185    B- session1794\n6 S31185    C+ session1795\n\n\nWe’ll explore the number of times each grade was assigned:\n\ngrade_distribution &lt;- grades |&gt; \n  count(grade)\n\nhead(grade_distribution)\n\n  grade    n\n1     A 1506\n2    A- 1381\n3    AU   27\n4     B  804\n5    B+ 1003\n6    B-  330\n\n\nExercise 1: Changing Order\nCheck out a column plot of the number of times each grade was assigned during the study period. This is similar to a bar plot, but where we define the height of a bar according to variable in our dataset.\n\ngrade_distribution |&gt; \n  ggplot(aes(x = grade, y = n)) +\n    geom_col()\n\n\n\n\n\n\n\nThe order of the grades is goofy! Construct a new column plot, manually reordering the grades from high (A) to low (NC) with “S” and “AU” at the end:\n\ngrade_distribution |&gt;\n   mutate(grade = fct_relevel(grade, c(\"A\", \"A-\", \"B+\", \"B\", \"B-\", \"C+\", \"C\", \"C-\", \"D+\", \"D\", \"D-\", \"NC\", \"S\", \"AU\"))) |&gt;\n   ggplot(aes(x = grade, y = n)) +\n     geom_col()\n\n\n\n\n\n\n\nConstruct a new column plot, reordering the grades in ascending frequency (i.e. how often the grades were assigned):\n\ngrade_distribution |&gt;\n  mutate(grade = reorder(grade, n)) |&gt;\n  ggplot(aes(x = grade, y = n)) +\n    geom_col()\n\n\n\n\n\n\n\nConstruct a new column plot, reordering the grades in descending frequency (i.e. how often the grades were assigned):\n\ngrade_distribution |&gt;\n  mutate(grade = fct_reorder(grade, n, .desc = TRUE)) |&gt;\n  ggplot(aes(x = grade, y = n)) +\n    geom_col()\n\n\n\n\n\n\n\nExercise 2: Changing Factor Level Labels\nIt may not be clear what “AU” and “S” stand for. Construct a new column plot that renames these levels “Audit” and “Satisfactory”, while keeping the other grade labels the same and in a meaningful order:\n\ngrade_distribution |&gt;\n  mutate(grade = fct_relevel(grade, c(\"A\", \"A-\", \"B+\", \"B\", \"B-\", \"C+\", \"C\", \"C-\", \"D+\", \"D\", \"D-\", \"NC\", \"S\", \"AU\"))) |&gt;\n  mutate(grade = fct_recode(grade, \"Satisfactory\" = \"S\", \"Audit\" = \"AU\")) |&gt;  # Multiple pieces go into the last 2 blanks\n  ggplot(aes(x = grade, y = n)) +\n    geom_col()",
    "crumbs": [
      "In-class Activities",
      "<span class='chapter-number'>20</span>  <span class='chapter-title'>Factors</span>"
    ]
  },
  {
    "objectID": "ica/ica-string.html",
    "href": "ica/ica-string.html",
    "title": "\n21  String\n",
    "section": "",
    "text": "Exercise 1: Time slots\nThe courses data includes actual data scraped from Mac’s class schedule. (Thanks to Prof Leslie Myint for the scraping code!!)\nIf you want to learn how to scrape data, take COMP/STAT 212, Intermediate Data Science! NOTE: For simplicity, I removed classes that had “TBA” for the days.\n\ncourses &lt;- read.csv(\"https://mac-stat.github.io/data/registrar.csv\")\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\n# Check it out\nhead(courses)\n\n       number   crn                                                name  days\n1 AMST 112-01 10318         Introduction to African American Literature M W F\n2 AMST 194-01 10073              Introduction to Asian American Studies M W F\n3 AMST 194-F1 10072 What’s After White Empire - And Is It Already Here?  T R \n4 AMST 203-01 10646 Politics and Inequality: The American Welfare State M W F\n5 AMST 205-01 10842                         Trans Theories and Politics  T R \n6 AMST 209-01 10474                   Civil Rights in the United States   W  \n             time      room             instructor avail_max\n1 9:40 - 10:40 am  MAIN 009       Daylanne English    3 / 20\n2  1:10 - 2:10 pm MUSIC 219          Jake Nagasawa   -4 / 16\n3  3:00 - 4:30 pm   HUM 214 Karin Aguilar-San Juan    0 / 14\n4 9:40 - 10:40 am  CARN 305          Lesley Lavery    3 / 25\n5  3:00 - 4:30 pm  MAIN 009              Myrl Beam   -2 / 20\n6 7:00 - 10:00 pm  MAIN 010         Walter Greason   -1 / 15\n\n\nUse our more familiar wrangling tools to warm up.\n\n# Construct a table that indicates the number of classes offered in each day/time slot\n# Print only the 6 most popular time slots\ncourses |&gt;\n  group_by(days, time)|&gt;\n  summarise(number = n())|&gt;\n  arrange(desc(number))|&gt;\n  head(6)\n\n`summarise()` has grouped output by 'days'. You can override using the\n`.groups` argument.\n\n\n# A tibble: 6 × 3\n# Groups:   days [2]\n  days    time             number\n  &lt;chr&gt;   &lt;chr&gt;             &lt;int&gt;\n1 \"M W F\" 10:50 - 11:50 am     76\n2 \" T R \" 9:40 - 11:10 am      71\n3 \"M W F\" 9:40 - 10:40 am      68\n4 \"M W F\" 1:10 - 2:10 pm       66\n5 \" T R \" 3:00 - 4:30 pm       62\n6 \" T R \" 1:20 - 2:50 pm       59\n\n\nExercise 2: Prep the data\nSo that we can analyze it later, we want to wrangle the courses data:\n\nLet’s get some enrollment info:\n\nSplit avail_max into 2 separate variables: avail and max.\nUse avail and max to define a new variable called enroll. HINT: You’ll need as.numeric()\n\n\n\nSplit the course number into 3 separate variables: dept, number, and section. HINT: You can use separate() to split a variable into 3, not just 2 new variables.\n\nStore this as courses_clean so that you can use it later.\n\ncourses_clean &lt;- courses|&gt;\n  separate(avail_max, c(\"avail\", \"max\"), sep = \"/\")|&gt;\n  mutate(avail = as.numeric(avail), max = as.numeric(max), enroll = max - avail)|&gt;\n  separate(number, c(\"dept\", \"number\", \"section\"), sep = \"[ -]\")\n\nExercise 3: Courses by department\nUsing courses_clean…\n\n# Identify the 6 departments that offered the most sections\ncourses_clean|&gt;\n  group_by(dept)|&gt;\n  summarise(count = n())|&gt;\n  arrange(desc(count))|&gt;\n  head(6)\n\n# A tibble: 6 × 2\n  dept  count\n  &lt;chr&gt; &lt;int&gt;\n1 SPAN     45\n2 BIOL     44\n3 ENVI     38\n4 PSYC     37\n5 CHEM     33\n6 COMP     31\n\n# Identify the 6 departments with the longest average course titles\ncourses_clean|&gt;\n  mutate(length = str_length(name))|&gt;\n  group_by(dept)|&gt;\n  summarise(sum = sum(length), count = n())|&gt;\n  mutate(avg = sum/count)|&gt;\n  arrange(desc(avg))|&gt;\n  head(6)\n\n# A tibble: 6 × 4\n  dept    sum count   avg\n  &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;\n1 WGSS    602    13  46.3\n2 INTL    497    12  41.4\n3 EDUC    473    12  39.4\n4 MCST    433    11  39.4\n5 POLI   1010    27  37.4\n6 AMST    821    22  37.3\n\n\nExercise 4: STAT courses\nPart a\nGet a subset of courses_clean that only includes courses taught by Alicia Johnson.\n\ncourses_clean|&gt;\n  filter(instructor == \"Alicia Johnson\")\n\n  dept number section   crn                         name  days            time\n1 STAT    253      01 10806 Statistical Machine Learning  T R  9:40 - 11:10 am\n2 STAT    253      02 10807 Statistical Machine Learning  T R   1:20 - 2:50 pm\n3 STAT    253      03 10808 Statistical Machine Learning  T R   3:00 - 4:30 pm\n        room     instructor avail max enroll\n1 THEATR 206 Alicia Johnson    -3  20     23\n2 THEATR 206 Alicia Johnson    -3  20     23\n3 THEATR 206 Alicia Johnson     2  20     18\n\n\nPart b\nCreate a new dataset from courses_clean, named stat, that only includes STAT sections. In this dataset:\n\n\nIn the course names:\n\nRemove “Introduction to” from any name.\nShorten “Statistical” to “Stat” where relevant.\n\n\nDefine a variable that records the start_time for the course.\nKeep only the number, name, start_time, enroll columns.\nThe result should have 19 rows and 4 columns.\n\n\nstat &lt;- courses_clean|&gt;\n  filter(dept == \"STAT\")|&gt;\n  mutate(name = str_replace(name, \"Introduction to\", \"\"), name = str_replace(name, \"Statistical\", \"Stat\"))|&gt;\n  separate(time,c(\"start_time\", NA), sep = \" - \")|&gt;\n  select(c(number, name, start_time, enroll))\n\nExercise 5: More cleaning\nIn the next exercises, we’ll dig into enrollments. Let’s get the data ready for that analysis here. Make the following changes to the courses_clean data. Because they have different enrollment structures, and we don’t want to compare apples and oranges, remove the following:\n\nall sections in PE and INTD (interdisciplinary studies courses)\nall music ensembles and dance practicums, i.e. all MUSI and THDA classes with numbers less than 100. HINT: !(dept == \"MUSI\" & as.numeric(number) &lt; 100)\nall lab sections. Be careful which variable you use here. For example, you don’t want to search by “Lab” and accidentally eliminate courses with words such as “Labor”.\n\nSave the results as enrollments (don’t overwrite courses_clean).\n\nenrollments &lt;- courses_clean |&gt; \n  filter(dept != c(\"PE\", \"INTD\"))|&gt;\n  filter(!(dept == \"MUSI\" & as.numeric(number) &lt; 100))|&gt;\n  filter(!(str_detect(section, \"L\")))\n\nExercise 6: Enrollment & departments\nExplore enrollments by department. You decide what research questions to focus on. Use both visual and numerical summaries.\nExercise 7: Enrollment & faculty\nLet’s now explore enrollments by instructor. In doing so, we have to be cautious of cross-listed courses that are listed under multiple different departments. Uncomment the code lines in the chunk below for an example.\n\n\n\n\n\n\nCommenting/Uncommenting Code\n\n\n\nTo comment/uncomment several lines of code at once, highlight them then click ctrl/cmd+shift+c.\n\n\n\nenrollments |&gt;\n  filter(dept %in% c(\"STAT\", \"COMP\"), number == 112, section == \"01\")\n\n  dept number section   crn                         name  days           time\n1 COMP    112      01 10248 Introduction to Data Science  T R  3:00 - 4:30 pm\n2 STAT    112      01 10249 Introduction to Data Science  T R  3:00 - 4:30 pm\n      room        instructor avail max enroll\n1 OLRI 254 Brianna Heggeseth     1  28     27\n2 OLRI 254 Brianna Heggeseth     1  28     27\n\n\nNotice that these are the exact same section! In order to not double count an instructor’s enrollments, we can keep only the courses that have distinct() combinations of days, time, instructor values. Uncomment the code lines in the chunk below.\n\nenrollments_2 &lt;- enrollments |&gt;\n  distinct(days, time, instructor, .keep_all = TRUE)\n\n# NOTE: By default this keeps the first department alphabetically\n# That's fine because we won't use this to analyze department enrollments!\nenrollments_2 |&gt;\n  filter(instructor == \"Brianna Heggeseth\", name == \"Introduction to Data Science\")\n\n  dept number section   crn                         name  days           time\n1 COMP    112      01 10248 Introduction to Data Science  T R  3:00 - 4:30 pm\n      room        instructor avail max enroll\n1 OLRI 254 Brianna Heggeseth     1  28     27\n\n\nNow, explore enrollments by instructor. You decide what research questions to focus on. Use both visual and numerical summaries.\nAverage class size of Physics department? Any relationship between course number and enrollment number?\nCAVEAT: The above code doesn’t deal with co-taught courses that have more than one instructor. Thus instructors that co-taught are recorded as a pair, and their co-taught enrollments aren’t added to their total enrollments. This is tough to get around with how the data were scraped as the instructor names are smushed together, not separated by a comma!\n\nenrollments_2|&gt;\n  filter(dept == \"PHYS\")|&gt;\n  summarise(average = mean(enroll))\n\n   average\n1 16.85714\n\nenrollments_2|&gt;\n  filter(dept == \"PHYS\")|&gt;\n  mutate(number = as.numeric(number))|&gt;\n  ggplot(aes(x = number, y = enroll)) + geom_point() + geom_line()\n\n\n\n\n\n\n\nOptional extra practice\n\n# Make a bar plot showing the number of night courses by day of the week\n# Use courses_clean\n\nDig Deeper: regex\nExample 4 gave 1 small example of a regular expression.\nThese are handy when we want process a string variable, but there’s no consistent pattern by which to do this. You must think about the structure of the string and how you can use regular expressions to capture the patterns you want (and exclude the patterns you don’t want).\nFor example, how would you describe the pattern of a 10-digit phone number? Limit yourself to just a US phone number for now.\n\nThe first 3 digits are the area code.\nThe next 3 digits are the exchange code.\nThe last 4 digits are the subscriber number.\n\nThus, a regular expression for a US phone number could be:\n\n\n[:digit:]{3}-[:digit:]{3}-[:digit:]{4} which limits you to XXX-XXX-XXXX pattern or\n\n\\\\([:digit:]{3}\\\\) [:digit:]{3}-[:digit:]{4} which limits you to (XXX) XXX-XXXX pattern or\n\n[:digit:]{3}\\\\.[:digit:]{3}\\\\.[:digit:]{4} which limits you to XXX.XXX.XXXX pattern\n\nThe following would include the three patterns above in addition to the XXXXXXXXXX pattern (no dashes or periods): - [\\\\(]*[:digit:]{3}[-.\\\\)]*[:digit:]{3}[-.]*[:digit:]{4}\nIn order to write a regular expression, you first need to consider what patterns you want to include and exclude.\nWork through the following examples, and the tutorial after them to learn about the syntax.\nEXAMPLES\n\n# Define some strings to play around with\nexample &lt;- \"The quick brown fox jumps over the lazy dog.\"\n\n\nstr_replace(example, \"quick\", \"really quick\")\n\n[1] \"The really quick brown fox jumps over the lazy dog.\"\n\n\n\nstr_replace_all(example, \"(fox|dog)\", \"****\") # | reads as OR\n\n[1] \"The quick brown **** jumps over the lazy ****.\"\n\n\n\nstr_replace_all(example, \"(fox|dog).\", \"****\") # \".\" for any character\n\n[1] \"The quick brown ****jumps over the lazy ****\"\n\n\n\nstr_replace_all(example, \"(fox|dog)\\\\.$\", \"****\") # at end of sentence only, \"\\\\.\" only for a period\n\n[1] \"The quick brown fox jumps over the lazy ****\"\n\n\n\nstr_replace_all(example, \"the\", \"a\") # case-sensitive only matches one\n\n[1] \"The quick brown fox jumps over a lazy dog.\"\n\n\n\nstr_replace_all(example, \"[Tt]he\", \"a\") # # will match either t or T; could also make \"a\" conditional on capitalization of t\n\n[1] \"a quick brown fox jumps over a lazy dog.\"\n\n\n\nstr_replace_all(example, \"[Tt]he\", \"a\") # first match only\n\n[1] \"a quick brown fox jumps over a lazy dog.\"\n\n\n\n# More examples\nexample2 &lt;- \"Two roads diverged in a yellow wood, / And sorry I could not travel both / And be one traveler, long I stood / And looked down one as far as I could\"\nexample3 &lt;- \"This is a test\"\n\n# Store the examples in 1 place\nexamples &lt;- c(example, example2, example3)\n\n\npat &lt;- \"[^aeiouAEIOU ]{3}\" # Regular expression for three straight consonants. Note that I've excluded spaces as well\n\nstr_detect(examples, pat) # TRUE/FALSE if it detects pattern\n\n[1]  TRUE  TRUE FALSE\n\n\n\nstr_subset(examples, pat) # Pulls out those that detects pattern\n\n[1] \"The quick brown fox jumps over the lazy dog.\"                                                                                                        \n[2] \"Two roads diverged in a yellow wood, / And sorry I could not travel both / And be one traveler, long I stood / And looked down one as far as I could\"\n\n\n\npat2 &lt;- \"[^aeiouAEIOU ][aeiouAEIOU]{2}[^aeiouAEIOU ]{1}\" # consonant followed by two vowels followed by a consonant\n\nstr_extract(example2, pat2) # extract first match\n\n[1] \"road\"\n\n\n\nstr_extract_all(example2, pat2, simplify = TRUE) # extract all matches\n\n     [,1]   [,2]   [,3]   [,4]   [,5]   [,6]  \n[1,] \"road\" \"wood\" \"coul\" \"tood\" \"look\" \"coul\"\n\n\nTUTORIAL\nTry out this interactive tutorial. Note that neither the tutorial nor regular expressions more generally are specific to R, but it still illustrates the main ideas of regular expressions.",
    "crumbs": [
      "In-class Activities",
      "<span class='chapter-number'>21</span>  <span class='chapter-title'>String</span>"
    ]
  }
]